{"title":"Borboletas frugívoras","markdown":{"headingText":"Borboletas frugívoras","containsRefs":false,"markdown":"```{r library, echo=FALSE, message=FALSE, warning=FALSE}\n\nlibrary(tidyverse)\nlibrary(data.table)\nlibrary(descr)\nlibrary(RColorBrewer)\nlibrary(kableExtra)\nlibrary(knitr)\nlibrary(DT)\nlibrary(plotly)\nlibrary(ggthemes)\nlibrary(forcats)\nlibrary(leaflet)\nlibrary(sf)\nlibrary(rgdal)\nlibrary(treemapify)\nlibrary(reshape2)\nlibrary(randomcoloR)\nlibrary(gridExtra)\n```\n\n\n\n</br>\n\n**Isabela Freitas Oliveira**^1-2^ & **Onildo João Marini Filho**^1^\n\n\n1. Centro Nacional de Pesquisa e Conservação da Biodiversidade do Cerrado e Restauração Ecológica - CBC  \n*Instituto Chico Mendes de Conservação da Biodiversidade – ICMBio*  \n*Parque Nacional de Brasília*  \n*Via Epia, BR-450, Km 8,5*  \n*70635-800 Brasília, DF*  \n\n2. Coordenação de Monitoramento da Biodiversidade - COMOB  \n*Instituto Chico Mendes de Conservação da Biodiversidade – ICMBio*  \n*Complexo Administrativo EQSW 103/104 s/n*  \n*70670-350 Brasília, DF*  \n\n</br>\n\n\nEm alguns grupos de insetos, a variação na riqueza, abundância e composição de espécies das comunidades ao longo do tempo vem sendo utilizada como indicador de alteração ambiental (@Gerlach_2013, @Arenhardt_2021, @Rodrigues_2019). No caso de borboletas, além desses parâmetros, a frequência relativa de ocorrência em nível de tribo também tem sido usada em estudos pontuais e programas de monitoramento (@Monitora_2018a). Esse indicador está relacionado tanto a alterações na vegetação (@Uehara_Prado_2006, @Ribeiro_2010) e eventos extremos climáticos, quanto a mudanças menos perceptíveis, como a redução na qualidade do ar (especialmente devido à presença de agrotóxicos) (@Smilanich_2012, @Ndakidemi_2016) e variações graduais do clima (temperatura e umidade) (@Devictor_2012). \n\nA abordagem que vem sendo utilizada no Programa Monitora considera a existência de um gradiente na associação entre as tribos de borboletas frugívoras e a estrutura das formações florestais, variando das florestas mais alteradas e/ou abertas até florestas mais adensadas e fechadas. O protocolo adotado pelo grupo de especialistas em borboletas considera que as tribos registradas estão relacionadas aos seguintes tipos de ambiente: \n\n- florestas fechadas/conservadas: Brassolini, Haeterini e Morphini. Em situações de perturbação da floresta a abundância relativa dessas tribos diminui consistentemente; \n\n- florestas abertas/alteradas (com abertura significativa no dossel): Ageroniini, Callicorini e Biblidini. As espécies dessas tribos são favorecidas por alterações na estrutura da floresta e suas abundâncias aumentam consistentemente com perturbações locais. \n\nAs tribos Preponini, Melanitini, Anaeini, Epicaliini, Epiphilini, Coeini e Satyrini não apresentam associação clara com ambientes florestais ou não demonstram tendência definida. A abundância dessas tribos pode aumentar ou diminuir em resposta a perturbações da floresta, como abertura de clareiras ou eventuais alterações no dossel. \n\n\n\n</br>\n\n## Implementação\n\n</br>\n\nNo período de 2014 a 2022 o protocolo amostral de borboletas frugívoras foi aplicado de forma integral ou parcial em 50 UCs federais, totalizando 134 estações amostrais (EAs) e 536 unidades amostrais (UAs - transecções com quatro armadilhas atrativas do tipo Van Someren-Rydon) em operação. A maior parte das amostragens (39 UCs, - 78%) foi realizada no bioma Amazônico, seis UCs (12%) foram amostradas na Mata Atlântica e cinco UCs (10%) no Cerrado. O PARNA da Chapada dos Veadeiros, no bioma Cerrado, teve suas amostragens interrompidas, pois constatou-se que as EA haviam sido implantadas em ambientes savânicos.  Com a realocação dessas EAs em ambiente florestal (mata de galeria) as amostragens deverão ser retomadas e a UC será reintegrada ao Programa. No PARNA de Brasília as amostragens ainda estão sendo realizadas em ambiente savânico, mas estas deverão ser consideradas parte do componente Campestre e Savânico do Programa.  Os dados brutos validados do alvo global Borboletas Frugívoras - Componente Florestal totalizam atualmente 82.349 registros. \n\nEm 2022 foram amostradas apenas duas UCs (PARNA de Pacaás Novos e REBIO do Uatumã), mas os dados não foram enviados à Coordenação Geral de Pesquisa e Monitoramento da Biodiversidade - COMOB a tempo de comporem este relatório. O PARNA de Brasília realizou a campanha de 2022 no *Open Data Kit - ODK*, com os dados inseridos no *i-naturalist* e em planilha *google drive*. Portanto, esses dados não foram incorporados neste relatório, sendo necessária sua futura conversão e configuração para o formato padronizado da planilha .xls atualmente utilizada no Programa. \n\n \n\nEm 11 de março de 2020 a Organização Mundial de Saúde decretou estado de pandemia pela COVID-19 (doença respiratória causada pelo vírus SARS-CoV-2), situação que se estendeu até o início de 2023. As rigorosas restrições de locomoção e interação social impostas nos dois primeiros anos de disseminação da doença (2020-2021) impactaram negativamente as atividades de campo do Programa Monitora, com interrupção ou redução no esforço amostral do alvo borboletas frugívoras (@fig-evolucao-implementacao e @fig-esforco-amostral). \n\n \n\nDas 50 UCs federais com coleta de dados de borboletas frugívoras, 33 (66%) já estão consolidadas, com pelo menos três unidades amostrais (transecções lineares) em operação. Três UCs (x%) retomaram as amostragens em 2022 (PARNA do Superagui, ESEC Marac e ESEC da Terra do Meio), seis UCs (x% - PARNA da Bocaina, PARNA da Bodoquena, PARNA da Serra dos Órgãos, PARNA do Juruena, REBIO Guaribas e RESEXChico Mendes) não estão em operação (UCs com mais de dois anos consecutivos sem amostragem) e apenas uma UC (x% - RESEX Renascer) interrompeu a amostragem em 2022. \n\n \n\nEm 2022, a amostragem de borboletas frugívoras foi realizada em 40 das 50 UCs integrantes do Programa Monitora, nos três biomas florestais (Tabela x). O ano de 2022 teve 21 UCs a mais do que 2021, com um aumento de 26% na quantidade de Estações Amostrais (EAs) implementadas (@fig-evolucao-implementacao). Todas as oito novas UCs que aderiram ao Monitora e iniciaram a amostragem de borboletas são amazônicas e apoiadas pelo Programa ARPA. As ? UCs apoiadas pelo ARPA apresentam os melhores índices de implementação dos protocolos de borboletas, sendo que ?? delas (??%) já estão consolidadas, com pelo menos três UAs sendo amostradas.  \n\n\n\n\n```{r grafico ucs_ativas_taxa_acumulado}\n#| label: fig-evolucao-implementacao\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Evolução do número de unidades de conservação (UCs) e de estações amostrais (EAs) com amostragem de borboletas frugívoras no Programa Monitora de 2014 a 2022.\"\n\n# Numero de UC's e EA's implementadas 214-2022\n# Script: Isabela Freitas Oliveira\n\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(stringr)\n\ndados_borboletas <- read.table(\"data/dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\ndados_borboletas$ano <- factor(dados_borboletas$ano)\ndados_borboletas <- dados_borboletas[dados_borboletas$ano != \"2023\", ]\n\n\n# Preparar os dados para o gráfico\ncontagem_uc_ea <- dados_borboletas %>%\n  group_by(ano) %>%\n  summarise(\n    num_uc = n_distinct(uc),\n    num_ea = n_distinct(uc_ea)\n  )\n\ndados_long <- contagem_uc_ea %>%\n  pivot_longer(\n    cols = -ano,\n    names_to = \"categoria\",\n    values_to = \"contagem\"\n  )\n\ndados_long$categoria <- factor(dados_long$categoria, levels = c(\"num_uc\",\"num_ea\"))\ngrafico_amostragens <- ggplot(dados_long, aes(x = ano, y = contagem, fill = categoria)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  geom_text(\n    aes(label = contagem), \n    position = position_dodge(width = 0.9), # ajustar 'width' para alinhar com as barras\n    vjust = -0.40, # ajustar 'vjust' para mover o texto um pouco acima das barras\n    size = 3\n  ) +\n  scale_fill_manual(\n    values = c(\"num_uc\" = \"#35978f\", \"num_ea\" = \"#c7eae5\"),\n    labels = c(\"UC\", \"EA\")) +\n  labs(\n    x = \"\",\n    y = \"Número de UC's e EA's amostradas\",\n    fill = \"\",\n    title = str_wrap(\"\", width = 35) # Quebra o título em duas linhas\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 14, hjust = 0, lineheight = 1.3),\n    legend.position = c(0.1, 1), # Define a posição da legenda no canto superior esquerdo\n    legend.justification = c(0, 1), # Define a justificação da legenda para o canto superior esquerdo\n    legend.box.just = \"left\", # Alinha a legenda à esquerda\n    legend.title = element_text(size = 12),\n    legend.text = element_text(size = 10),\n    axis.title.x = element_text(size = 14), \n    axis.text.x = element_text(size = 10),  \n    axis.line = element_line(colour = \"gray40\"),\n    axis.line.x = element_blank(),\n    axis.text.y = element_text(size = 10),\n    axis.ticks.y = element_line(color = \"black\"),\n    panel.grid.major = element_blank(),  # remove as linhas principais da grade\n    panel.grid.minor = element_blank() \n  ) +\n  scale_y_continuous(limits = c(0, 115))\n\nprint(grafico_amostragens)\n\n#knitr::include_graphics(\"imagens/cap04/bo_evolucao_implementacao.JPG\")\n\n```\n\n\nO esforço amostral vem aumentando quase linearmente a uma taxa de 15-20% ao ano, desde o início da implementação do Programa Monitora. O número de registros aumentou desproporcionalmente ao esforço em 2016, aparentemente devido a fatores climáticos. O número acumulado de registros de borboletas amostradas em nível de tribo (protocolo básico) totalizou ?? indivíduos (@fig-esforco-amostral). \n\n\n```{r grafico ucs_ativas_taxa_acumulado}\n#| label: fig-esforco-amostral\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no número de registros de borboletas frugívoras e esforço amostral (dias*armadilhas) somada para todas as UCs participantes do Programa Monitora.\"\n\n\n#Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\n\n# Ler e limpar dados_borboletas\ndados_borboletas <- read.table(\"data/dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\ndados_borboletas <- dados_borboletas %>%\n  filter(ano != \"2023\", !is.na(tribo))\n\n\n# Calcular o esforço amostral para cada combinação de uc_ea, expedicao e ano\nesforco_por_expedicao <- dados_borboletas %>%\n  group_by(uc_ea, uc, expedicao, ano) %>%\n  summarize(\n    max_dia_amostragem = max(dia_amostragem) - 1,\n    .groups = 'drop'\n  ) %>%\n  mutate(\n    esforco_amostral = 16 * max_dia_amostragem\n  )\n\n# Agregar o esforço de amostragem para cada uc_ea e ano\nesforco_total_por_ea_ano <- esforco_por_expedicao %>%\n  group_by(uc_ea, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregar o esforço de amostragem para cada uc e ano\nesforco_total_por_uc_ano <- esforco_por_expedicao %>%\n  group_by(uc, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n\n# Agregação para obter o esforço total por ano por uc\nesforco_por_ano_uc <- esforco_total_por_uc_ano %>%\n  group_by(ano,uc) %>%\n  summarize(\n    esforco = sum(esforco_total_ano),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o esforço total por ano\nesforco_por_ano <- esforco_total_por_uc_ano %>%\n  group_by(ano) %>%\n  summarize(\n    esforco = sum(esforco_total_ano),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o número total de indivíduos por ano\nnum_ind_por_ano <- dados_borboletas %>%\n  group_by(ano) %>%\n  summarize(\n    num_ind = sum(individuos, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n\n# Juntar as duas tabelas agregadas\ntabela_final_esfoco <- left_join(esforco_por_ano, num_ind_por_ano, by = \"ano\")\n#write.csv(tabela_final_esfoco, \"tabela_final_esfoco.csv\", row.names = FALSE)\n\n\n#####Fazer o gráfico de Abundancia e esforço\n# Definindo os dados para cada série separadamente\ndados_esforco <- tabela_final_esfoco[, c(\"ano\", \"esforco\")]\nnames(dados_esforco)[2] <- \"valor\"\ndados_esforco$tipo <- \"Esforço\"\n\ndados_abundancia <- tabela_final_esfoco[, c(\"ano\", \"num_ind\")]\nnames(dados_abundancia)[2] <- \"valor\"\ndados_abundancia$tipo <- \"Abundância\"\n\n# Juntando os dados\ndados_plot <- rbind(dados_esforco, dados_abundancia)\n\n# Criando o gráfico\ngrafico <- ggplot(data = dados_plot, aes(x = ano, y = valor, colour = tipo, linetype = tipo, shape = tipo)) +\n  geom_line(size = 1.0) +\n  geom_point(size = 3) +\n  scale_colour_manual(values = c(\"Esforço\" = \"#35978f\", \"Abundância\" = \"#dfc27d\")) +\n  scale_linetype_manual(values = c(\"Esforço\" = \"solid\", \"Abundância\" = \"solid\")) +\n  scale_shape_manual(values = c(\"Esforço\" = 16, \"Abundância\" = 17)) +\n  scale_y_continuous(\n    \"Esforço Amostral e Abundância\",\n    labels = scales::label_number(big.mark = \".\", decimal.mark = \",\"),\n    limits = c(0, 25000)\n  ) +\n  scale_x_continuous(breaks = tabela_final_esfoco$ano) +\n  labs(\n    title = \"\",\n    x = \"Ano\",\n    y = \"Esforço Amostral e Abundância\",\n    colour = \"\",\n    shape = \"\", # Isso ajuda a garantir que as formas correspondam na legenda\n    linetype = \"\" # Isso ajuda a garantir que os tipos de linha correspondam na legenda\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(hjust = -0.5, size = 18, lineheight = 1.5), # Ajuste o lineheight conforme necessário\n    legend.position = c(0.10, 0.93), # Define a posição da legenda no canto superior esquerdo\n    legend.justification = c(0, 1), # Define a justificação da legenda para o canto superior esquerdo\n    legend.box.just = \"left\", # Alinha a legenda à esquerda\n    legend.box.background = element_rect(fill = \"white\", color = \"white\"),\n    axis.ticks.y = element_line(color = \"black\"),\n    axis.text.y = element_text(margin = margin(r = 5)),\n    axis.text.x = element_text(margin = margin(r = 12)),\n    axis.title.y = element_text(size = 10, margin = margin(r = 10)),\n    axis.title.x = element_text(size = 10, margin = margin(t = 10)),\n    axis.text = element_text(size = 10),\n    axis.line = element_line(colour = \"gray40\"),\n    legend.text = element_text(size = 10),\n    axis.line.x = element_blank(),\n    panel.grid.minor = element_blank()\n  )\n\nprint(grafico)\n\n\n#knitr::include_graphics(\"imagens/cap04/bo_esforco.JPG\")\n\n```\n\n\n\n### Considerações sobre as amostragens na Mata Atlântica\n\n</br>\n\nPoucos indivíduos vêm sendo capturados nas UCs da Mata Atlântica. Esse padrão de baixa taxa de capturas vem sendo observado nas UCs da Serra do Mar e baixada litorânea (PARNAs da Serra dos Órgãos, da Serra da Bocaina e do Superagui). Ainda não sabemos o motivo do método não estar gerando resultados similares aos obtidos para UCs em outros ambientes. É possível que o período ideal de coleta seja o final da estação seca, devido ao padrão bimodal de ocorrência de borboletas nesses ambientes (@Ribeiro_2010; @Santos_2017), bem como em outras regiões montanhosas da Mata Atlântica.  \n\nNesse sentido, recomendamos que sejam exploradas outras possibilidades de desenho amostral para a Mata Atlântica, que possam ajudar a ampliar a quantidade de dados. Sugerimos implementar experimentalmente uma amostragem adicional no final da estação seca, nas UCs em que a logística permitir. Essa sugestão pode ser estendida para matas paludosas e sazonalmente alagadas. Outra questão importante a ser considerada na escolha do local de instalação das unidades amostrais é evitar a implantação das estações amostrais na face sul das montanhas nessas UCs.  Pode-se também avaliar a possibilidade de se amostrar no dossel das matas paludosas e sazonalmente alagadas, uma vez que a comunidade de sub-bosque de matas muito sombreadas e alagadas frequentemente se mostra pouco diversa (@Bellaver_2012; @DeVries_1987).  \n\n</br>\n\n## Resultados\n\n</br>\n\n### Amazônia\n\n</br>\n\n#### Síntese por região climática\n\n</br>\n\n\nO objetivo dessa seção é apresentar análises integrativas mostrando padrões regionais ou geográficos, indicando alterações na biodiversidade em escala ampla. Neste período inicial do Programa Monitora estão sendo estabelecidos os padrões normais de riqueza, abundância, composição e frequência relativa para cada UC e, possivelmente, para cada região (marco zero). Os primeiros resultados apresentados constituem a abundância relativa, representada pela proporção de registros de cada tribo, por região climática (@fig-regiao-climatica-central-amazonica a @fig-regiao-climatica-sudeste-amazonica). \n\nAinda não temos dados populacionais para borboletas, uma vez que nas poucas UCs que iniciaram a aplicação do protocolo avançado os indivíduos capturados ainda não foram identificados, não sendo possível gerar tendências em nível de espécie. Uma das formas pretendidas para apresentação desse tipo de resultado é por meio de um índice de abundância, considerando o esforço amostral para cada população monitorada – igual ou similar ao Índice Planeta Vivo (@Pereira_2006). Para isso, necessitamos de dados populacionais coletados em amostragens anuais consecutivas para cada uma das espécies em cada unidade de conservação ou estação amostral. Com esse tipo de dado, poderemos obter tendências de aumento ou diminuição de populações em EAs, UCs ou regiões climáticas (@WWF_2018). \n\nMesmo não tendo ainda acesso a dados populacionais, iremos utilizar o índice de abundância em nível de tribos, para servir de base para futuras análises. Este método já foi utilizado no relatório anterior do Programa Monitora (@Monitora_2018a).  \n\n\nOs períodos de amostragem propostos no protocolo do Programa Monitora para borboletas frugívoras na Amazônia seguem a mesma lógica aplicada para as regiões Central e Sudeste do Brasil, onde temos alta abundância populacional e maior diversidade de espécies de borboletas frugívoras no final do período de chuvas intensas (@Checa_2009). Os períodos de amostragem para as regiões amazônicas apresentados a seguir baseiam-se na caracterização climática associada ao padrão de chuvas em toda a Amazônia (@fig-regioes-climaticas, reproduzida de @Marengo_2001). A partir da determinação dos regimes de chuva regionais, delimitamos alguns polígonos  contemplando as UCs integrantes do Programa Monitora, possibilitando estabelecer  a melhor época para amostragem (Tabela x),  considerando o regime de chuvas como uma característica regional importante para as borboletas frugívoras (Figura 4.4). \n\n</br>\n\n\n\n```{r grafico ucs_ativas_taxa_acumulado}\n#| label: fig-regioes_climaticas\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Regiões climáticas e regimes de chuva na Amazônia (@Marengo_2001).\"\n\n#knitr::include_graphics(\"imagens/cap04/bo_regioes_climaticas.JPG\")\n\n```\n\n\n</br>\n\n```{r grafico ucs_ativas_taxa_acumulado}\n#| label: fig-regioes-climaticas\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '60%'\n#| fig-cap: \"Mapa mostrando a proposta de distribuição das UCs participantes do Programa Monitora nos polígonos das regiões climáticas da Amazônia definidos em função do regime de chuvas.\"\n\nknitr::include_graphics(\"imagens/cap04/bo_mapa_ucs.jpeg\")\n\n```\n\n\n</br>\n\nTabela x. Localização das UCs em relação às regiões climáticas da Amazônia, incluindo o período sugerido de amostragens de borboletas indicado como o final das chuvas. As UCs com \\* situam-se entre duas ou mais regiões climáticas (q. = quinzena). As UCs marcadas com \\# ainda não iniciaram a amostragem de borboletas.  \n\n</br>\n\n\n#### Representação de UCs nas regiões climáticas amazônicas\n\n</br>\n\n\nA região Amazônica concentra a maior parte do esforço amostral de borboletas frugívoras no Programa Monitora, com um crescimento gradativo de 2014 a 2022 no número de UCs e de EAs em quase todas as regiões climáticas (@fig-numero-ucs-eas-amostradas).  \n\n\n```{r numero-ucs-amostradas}\n#| label: fig-numero-ucs-amostradas\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '60%'\n\n\n\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(stringr)\n\n# Carregar os dados\ndados_borboletas <- read.table(\"data/dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\ndados_borboletas <- dados_borboletas[dados_borboletas$ano != \"2023\", ]\n\n# Converter o ano para fator\ndados_borboletas$ano <- factor(dados_borboletas$ano)\n\n# Filtrar os dados para incluir apenas regiões da Amazônia\ndados_amazonia <- dados_borboletas %>%\n  filter(regiao %in% c(\"central\", \"sudoeste\", \"sudeste\", \"norte\", \"leste\"))\n\n# Preparar os dados para o gráfico\ncontagem_uc_amazonia <- dados_amazonia %>%\n  group_by(ano, regiao) %>%\n  summarise(num_uc = n_distinct(uc))\n\n# Cores para cada região da Amazônia\ncores_amazonia <- c(\n  \"#c7eae5\",\n  \"#80cdc1\",\n  \"#35978f\",\n  \"#01665e\",\n  \"#003c30\"\n)\n\n# Gráfico\ngrafico_uc_amazonia <- ggplot(contagem_uc_amazonia, aes(x = ano, y = num_uc, fill = regiao)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_manual(values = cores_amazonia) + # Definindo as cores manualmente\n  labs(\n    x = \"\",\n    y = \"Número de UCs amostradas\",\n    fill = \"\",\n    title = \"\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 14, hjust = 0, lineheight = 1.3),\n    legend.position = c(0.1, 0.80), # Define a posição da legenda no canto superior esquerdo\n    #legend.justification = c(0.1, 1), # Define a justificação da legenda para o canto superior esquerdo\n    legend.box.just = \"left\", # Alinha a legenda à esquerda\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n    axis.title.x = element_text(size = 12), \n    axis.text.x = element_text(size = 10),  \n    #axis.line = element_line(colour = \"gray40\"),\n    axis.line.x = element_blank(),\n    #axis.text.y = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.line = element_line(colour = \"gray40\"),\n    axis.ticks.y = element_line(color = \"black\")\n    \n  ) +\n  scale_y_continuous(limits = c(0, 15))\n\n# Exibir o gráfico\nprint(grafico_uc_amazonia)\n\n##f1\ngrafico_uc_amazonia <- ggplot(contagem_uc_amazonia, aes(x = ano, y = num_uc, fill = regiao)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  #geom_text(aes(label = num_uc), position = position_dodge(width = 0.9), vjust = -0.5, size = 3) + # Adicionando os valores\n  scale_fill_manual(values = cores_amazonia) + # Definindo as cores manualmente\n  labs(\n    x = \"\",\n    y = \"Número de UCs amostradas\",\n    fill = \"\",\n    title = \"Número de UCs\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 14, hjust = 0.5, lineheight = 1.3),\n    legend.position = c(0.1, 0.80), # Define a posição da legenda no canto superior esquerdo\n    #legend.justification = c(0.1, 1), # Define a justificação da legenda para o canto superior esquerdo\n    legend.box.just = \"left\", # Alinha a legenda à esquerda\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n    axis.title.x = element_text(size = 12), \n    axis.text.x = element_text(size = 10),  \n    #axis.line = element_line(colour = \"gray40\"),\n    axis.line.x = element_blank(),\n    #axis.text.y = element_blank(),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.line = element_line(colour = \"gray40\"),\n    axis.ticks.y = element_line(color = \"black\")\n    \n  ) +\n  scale_y_continuous(limits = c(0, 15))\n\n# Exibir o gráfico\nprint(grafico_uc_amazonia)\n\n\n# Salvar a imagem usando ggsave()\n# ggsave(\n#   filename = \"grafico_numeros_de_uc_amazonia_f1.png\",\n#   plot = grafico_uc_amazonia,\n#   device = \"png\",\n#   path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",\n#   dpi = 300,\n#   width = 12,\n#   height = 8,\n#   units = \"in\"\n# )\n\n\n```\n\n\n\n\n</br>\n\n```{r numero-eas-amostradas}\n#| label: fig-numero-eas-amostradas\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '60%'\n\n\n# Carregar os dados\ndados_borboletas <- read.table(\"data/dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\ndados_borboletas <- dados_borboletas[dados_borboletas$ano != \"2023\", ]\n\n# Converter o ano para fator\ndados_borboletas$ano <- factor(dados_borboletas$ano)\n\n# Filtrar os dados para incluir apenas regiões da Amazônia\ndados_amazonia <- dados_borboletas %>%\n  filter(regiao %in% c(\"central\", \"sudoeste\", \"sudeste\", \"norte\", \"leste\"))\n\n# Preparar os dados para o gráfico\ncontagem_ea_amazonia <- dados_amazonia %>%\n  group_by(ano, regiao) %>%\n  summarise(num_ea = n_distinct(uc_ea))\n\n# Cores para cada região da Amazônia\ncores_amazonia <- c(\n  \"#f6e8c3\",\n  \"#dfc27d\",\n  \"#bf812d\",\n  \"#8c510a\",\n  \"#543005\"\n)\n\n# Gráfico\ngrafico_ea_amazonia <- ggplot(contagem_ea_amazonia, aes(x = ano, y = num_ea, fill = regiao)) +\n  geom_bar(stat = \"identity\", position = \"dodge\") +\n  scale_fill_manual(values = cores_amazonia) + # Definindo as cores manualmente\n  labs(\n    x = \"Ano\",\n    y = \"Número de EAs amostradas\",\n    fill = \"\",\n    title = \"Número de EAs\"\n  ) +\n  theme_minimal() +\n  theme(\n    plot.title = element_text(size = 14, hjust = 0.5, lineheight = 1.3),\n    legend.position = c(0.1, 0.8),\n    legend.title = element_text(size = 10),\n    legend.text = element_text(size = 8),\n    axis.title.x = element_text(size = 12),\n    axis.text.x = element_text(size = 10),\n    axis.title.y = element_text(size = 10),\n    axis.text.y = element_text(size = 8),\n    axis.line = element_line(colour = \"gray40\"),\n    axis.line.x = element_blank(),\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    axis.ticks.y = element_line(color = \"black\")\n  ) +\n  scale_y_continuous(limits = c(0, 40))\n\n# Exibir o gráfico\nprint(grafico_ea_amazonia)\n\n# Salvar a imagem usando ggsave()\n# ggsave(\n#   filename = \"grafico_numeros_de_ea_amazonia.png\",\n#   plot = grafico_ea_amazonia,\n#   device = \"png\",\n#   path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",\n#   dpi = 300,\n#   width = 12,\n#   height = 8,\n#   units = \"in\"\n# )\n\n```\n\n</br>\n\n\n```{r numero-ucs-eas-amostradas}\n#| label: fig-numero-ucs-eas-amostradas\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '75%'\n#| fig-cap: \"Número de unidades de conservação (UCs) e estações amostrais (EAs) do Programa Monitora na região amazônica por região climática com amostragem de borboletas frugívoras implementadas de 2014 a 2022.\"\n\n\n\nlibrary(gridExtra)\ncombinado<-grid.arrange (grafico_uc_amazonia, grafico_ea_amazonia, ncol=1)\n\n# ggsave(\n#   filename = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/ucs_eas_combinados.png\",\n#   plot = combinado,\n#   device = \"png\",\n#   dpi = 300,\n#   width = 14,\n#   height = 12,\n#   units = \"in\"\n# )\n\n```\n\n\n</br>\n\n\nAs amostragens de borboletas frugívoras na região climática Central Amazônica foram realizadas em 12 UCs: PARNA da Amazônia, PARNA dos Campos Amazônicos, PARNA do Jaú, PARNA Nascentes do Lago Jari, REBIO do Jaru, REBIO do Uatumã, ESEC da Terra do Meio, FLONA de Tapajós, RESEX do Lago do Capanã Grande, RESEX Riozinho do Anfrísio, RESEX Tapajós-Arapiuns e RESEX Verde para Sempre. Nessa região, 41 EAs foram amostradas de 2014 a 2022.  \n\n```{r ajustes dos gráficos de assinaturas}\n#| label: ajustes-graficos-assinaturas\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n\n\n# Gráficos de dados Borboletas - Protocolo básico - Regiões da Amazônia - individual\n### Tribos com asterisco estão ausentes nos dados\n## Script: Isabela Freitas Oliveira\n\n# Carregar bibliotecas\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(scales)\nlibrary(tools)\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n# Função auxiliar para ajustar o título\najustar_titulo <- function(titulo) {\n  palavras <- strsplit(titulo, \" \")[[1]]\n  \n  # Palavras que necessitam de correção de acentuação\n  correcoes <- list(\n    \"leste\" = \"Região climática Leste Amazônica\", \"sudoeste\" = \"Região climática Sudoeste Amazônica\", \"central\" = \"Região climática Central Amazônica\",\n    \"norte\" = \"Região climática Norte Amazônica\", \"sudeste\" = \"Região climática Sudeste Amazônica\"\n  )\n  \n  palavras <- sapply(palavras, function(palavra) {\n    # Aplicar regras específicas para certas palavras\n    if (tolower(palavra) %in% c(\"esec\", \"flona\", \"rebio\", \"resex\", \"parna\")) {\n      return(toupper(palavra))\n    } else if (tolower(palavra) %in% c(\"de\", \"da\", \"do\", \"dos\", \"das\")) {\n      return(tolower(palavra))\n    } else {\n      # Corrigir acentuação, se necessário\n      palavra_corrigida <- tolower(palavra)\n      if (palavra_corrigida %in% names(correcoes)) {\n        return(correcoes[[palavra_corrigida]])\n      } else {\n        return(tools::toTitleCase(palavra))\n      }\n    }\n  })\n  \n  return(paste(palavras, collapse = \" \"))\n}\n\n# Função para gerar o gráfico para cada região\ngerar_grafico_por_regiao <- function(dados, nome_regiao) {\n  # Preparar o título\n  titulo <- ajustar_titulo(nome_regiao)  # Utilizando a função de ajuste de título aqui\n  \n  # Filtrar os dados para a região atual\n  dados_regiao <- subset(dados, regiao == nome_regiao & bioma == \"Amazonia\")\n  dados_regiao <- dados_regiao[!is.na(dados_regiao$tribo), ] #tirar os dados 'NA' que estão na tribo\n  \n  # Calcular o total de indivíduos por ano para a região atual\n  total_individuos_por_ano <- dados_regiao %>%\n    group_by(ano) %>%\n    summarise(total = sum(soma_individuos), .groups = 'drop')\n  \n  # Agregar dados por ano e tribo\n  dados_agregados <- dados_regiao %>%\n    group_by(ano, tribo) %>%\n    summarize(frequencia = sum(soma_individuos), .groups = 'drop')\n  \n  # Calcular totais e proporções\n  total_por_ano <- dados_agregados %>%\n    group_by(ano) %>%\n    summarize(total = sum(frequencia), .groups = 'drop')\n  \n  dados_agregados <- left_join(dados_agregados, total_por_ano, by = \"ano\") %>%\n    mutate(proporcao = frequencia / total * 100)\n  \n  # Ajustar proporções\n  dados_agregados <- dados_agregados %>%\n    group_by(ano) %>%\n    mutate(diferenca = 100 - sum(proporcao),\n           proporcao_ajustada = ifelse(proporcao == max(proporcao), proporcao + diferenca, proporcao)) %>%\n    ungroup() %>%\n    dplyr::select(-diferenca, -proporcao) %>%\n    rename(proporcao = proporcao_ajustada)\n  \n  # Ordem específica das tribos\n  ordem_tribos <- c(\n    \"Brassolini\", \"Morphini\", \"Haeterini\", \n    \"Preponini\", \"Melanitini\", \"Anaeini\", \n    \"Epicaliini\",\"Epiphilini\", \"Coeini\",\n    \"Satyrini\",\n    \"Callicorini\", \"Biblidini\",\"Ageroniini\"\n  )\n  \n  # Cores correspondentes às tribos - BLINDSAFE colors (3 categorias de verde, 7 categorias de cinza e 3 categorias de marrom)\n  cores_tribos <- c(\n    \"Brassolini\" = \"#35978f\", \"Morphini\" = \"#80cdc1\", \"Haeterini\" = \"#c7eae5\", \n    \"Preponini\" = \"gray65\", \"Melanitini\" = \"gray70\", \"Anaeini\" = \"gray75\", \n    \"Epicaliini\" = \"gray80\", \"Epiphilini\" = \"gray85\", \"Coeini\" = \"gray90\",\n    \"Satyrini\" = \"gray95\",\n    \"Callicorini\" = \"#f6e8c3\", \"Biblidini\" = \"#dfc27d\",\"Ageroniini\" = \"#bf812d\"\n  )\n  \n  # Ajustar a ordem e as cores das tribos com base nas tribos presentes\n  cores_tribos <- cores_tribos[ordem_tribos]\n  \n  # Assegurar que a coluna 'tribo_clean' respeite a ordem definida\n  dados_agregados$tribo <- factor(dados_agregados$tribo, levels = ordem_tribos)\n  \n  # Criar um data frame com a frequência agregada por tribo\n  #frequencias_por_tribo_ano <- aggregate(frequencia ~ tribo + ano, dados_agregados, sum)\n  \n  # Criar um data frame com a frequência agregada por tribo\n  frequencias_por_tribo_ano <- aggregate(frequencia ~ tribo, dados_agregados, sum)\n  \n  # Criar uma função para determinar se um asterisco deve ser adicionado ao nome da tribo\n  adicionar_asterisco <- function(nome_tribo) {\n    # Verificar se existe alguma frequência igual a zero para essa tribo em qualquer ano\n    if (any(frequencias_por_tribo_ano$tribo == nome_tribo & frequencias_por_tribo_ano$frequencia == 0)) {\n      return(paste0(nome_tribo, \"*\"))\n    } else {\n      return(nome_tribo)\n    }\n  }\n  \n  # Aplicar a função a cada tribo para criar o vetor de rótulos\n  labels_tribos <- sapply(ordem_tribos, adicionar_asterisco)\n  \n  # Construir o gráfico\n  gg <- ggplot(dados_agregados) +\n    geom_bar(aes(x = ano, y = proporcao, fill = tribo), stat = \"identity\", position = position_stack(reverse = FALSE)) +\n    geom_text(data = total_individuos_por_ano, aes(x = ano, y = 100, label = total), vjust = -0.5, size = 3, hjust = 0.5)+\n    scale_y_continuous(labels = scales::number_format(scale = 1, accuracy = 1), limits = c(0, 100))+\n    scale_x_discrete(expand = c(0, 0)) +\n    scale_fill_manual(values = cores_tribos, \n                      labels = labels_tribos,\n                      breaks = ordem_tribos) +\n    labs(title = titulo,\n         x = \"Ano\",\n         y = \"Frequência relativa de ocorrência (%)\",\n         fill = \"Tribo\") +\n    theme_minimal() +\n    theme(legend.position = \"right\", \n          legend.title = element_text(size = 12), \n          legend.text = element_text(size = 10), \n          plot.title = element_text(hjust = 0.5, size = 16), \n          plot.subtitle = element_text(hjust = 0.5, size = 14),\n          axis.text = element_text(size = 12), \n          axis.title = element_text(size = 12),\n          axis.ticks.y = element_line(color = \"black\"),\n          axis.line = element_line(colour = \"gray40\"),\n          axis.line.x = element_blank()) +\n    guides(fill = guide_legend(title = \"Tribos\", reverse = FALSE))\n  \n  \n  # Exibir o gráfico\n  print(gg)\n}\n\n# Carregar e preparar os dados\nresultado_final <- read.csv(\"data/resultado_final.csv\", header = TRUE)\nresultado_final$ano <- factor(resultado_final$ano)\nresultado_final$tribo <- gsub(\"\\\\*\", \"\", resultado_final$tribo)\n#resultado_final <- resultado_final[resultado_final$ano != \"2023\", ]\n\n\n#------------------------------------------------\n# # Função auxiliar para ajustar o título\n# ajustar_titulo <- function(titulo) {\n#   palavras <- strsplit(titulo, \" \")[[1]]\n# \n#   # Palavras que necessitam de correção de acentuação\n#   correcoes <- list(\n#     \"leste\" = \"Região climática Leste Amazônica\", \"sudoeste\" = \"Região climática Sudoeste Amazônica\", \"central\" = \"Região climática Central Amazônica\",\n#     \"norte\" = \"Região climática Norte Amazônica\", \"sudeste\" = \"Região climática Sudeste Amazônica\"\n#   )\n# \n#   palavras <- sapply(palavras, function(palavra) {\n#     # Aplicar regras específicas para certas palavras\n#     if (tolower(palavra) %in% c(\"esec\", \"flona\", \"rebio\", \"resex\", \"parna\")) {\n#       return(toupper(palavra))\n#     } else if (tolower(palavra) %in% c(\"de\", \"da\", \"do\", \"dos\", \"das\")) {\n#       return(tolower(palavra))\n#     } else {\n#       # Corrigir acentuação, se necessário\n#       palavra_corrigida <- tolower(palavra)\n#       if (palavra_corrigida %in% names(correcoes)) {\n#         return(correcoes[[palavra_corrigida]])\n#       } else {\n#         return(tools::toTitleCase(palavra))\n#       }\n#     }\n#   })\n# \n#   return(paste(palavras, collapse = \" \"))\n# }\n# \n# # Função para gerar o gráfico para cada região\n# gerar_grafico_por_regiao <- function(dados, nome_regiao) {\n#   # Preparar o título\n#   titulo <- ajustar_titulo(nome_regiao)  # Utilizando a função de ajuste de título aqui\n# \n#   # Filtrar os dados para a região atual\n#   dados_regiao <- subset(dados, regiao == nome_regiao & bioma == \"Amazonia\")\n#   dados_regiao <- dados_regiao[!is.na(dados_regiao$tribo), ] #tirar os dados 'NA' que estão na tribo\n# \n#   # Calcular o total de indivíduos por ano para a região atual\n#   total_individuos_por_ano <- dados_regiao %>%\n#     group_by(ano) %>%\n#     summarise(total = sum(soma_individuos), .groups = 'drop')\n# \n#   # Agregar dados por ano e tribo\n#   dados_agregados <- dados_regiao %>%\n#     group_by(ano, tribo) %>%\n#     summarize(frequencia = sum(soma_individuos), .groups = 'drop')\n# \n#   # Calcular totais e proporções\n#   total_por_ano <- dados_agregados %>%\n#     group_by(ano) %>%\n#     summarize(total = sum(frequencia), .groups = 'drop')\n# \n#   dados_agregados <- left_join(dados_agregados, total_por_ano, by = \"ano\") %>%\n#     mutate(proporcao = frequencia / total * 100)\n# \n#   # Ajustar proporções\n#   dados_agregados <- dados_agregados %>%\n#     group_by(ano) %>%\n#     mutate(diferenca = 100 - sum(proporcao),\n#            proporcao_ajustada = ifelse(proporcao == max(proporcao), proporcao + diferenca, proporcao)) %>%\n#     ungroup() %>%\n#     dplyr::select(-diferenca, -proporcao) %>%\n#     rename(proporcao = proporcao_ajustada)\n# \n#   # Ordem específica das tribos\n#   ordem_tribos <- c(\n#     \"Brassolini\", \"Morphini\", \"Haeterini\",\n#     \"Satyrini\", \"Coeini\", \"Epiphilini\",\n#     \"Epicaliini\", \"Anaeini\", \"Melanitini\",\n#     \"Preponini\", \"Callicorini\", \"Biblidini\",\n#     \"Ageroniini\"\n#   )\n# \n#   # Cores correspondentes às tribos - BLINDSAFE colors (3 categorias de verde, 7 categorias de cinza e 3 categorias de marrom)\n#   cores_tribos <- c(\n#     \"Brassolini\" = \"#35978f\", \"Morphini\" = \"#80cdc1\", \"Haeterini\" = \"#c7eae5\",\n#     \"Satyrini\" = \"gray95\", \"Coeini\" = \"gray90\", \"Epiphilini\" = \"gray85\",\n#     \"Epicaliini\" = \"gray80\", \"Anaeini\" = \"gray75\", \"Melanitini\" = \"gray70\",\n#     \"Preponini\" = \"gray65\", \"Callicorini\" = \"#f6e8c3\", \"Biblidini\" = \"#dfc27d\",\n#     \"Ageroniini\" = \"#bf812d\"\n#   )\n# \n#   # Ajustar a ordem e as cores das tribos com base nas tribos presentes\n#   cores_tribos <- cores_tribos[ordem_tribos]\n# \n#   # Assegurar que a coluna 'tribo_clean' respeite a ordem definida\n#   dados_agregados$tribo <- factor(dados_agregados$tribo, levels = ordem_tribos)\n# \n#   # Criar um data frame com a frequência agregada por tribo\n#   #frequencias_por_tribo_ano <- aggregate(frequencia ~ tribo + ano, dados_agregados, sum)\n# \n#   # Criar um data frame com a frequência agregada por tribo\n#   frequencias_por_tribo_ano <- aggregate(frequencia ~ tribo, dados_agregados, sum)\n# \n#   # Criar uma função para determinar se um asterisco deve ser adicionado ao nome da tribo\n#   adicionar_asterisco <- function(nome_tribo) {\n#     # Verificar se existe alguma frequência igual a zero para essa tribo em qualquer ano\n#     if (any(frequencias_por_tribo_ano$tribo == nome_tribo & frequencias_por_tribo_ano$frequencia == 0)) {\n#       return(paste0(nome_tribo, \"*\"))\n#     } else {\n#       return(nome_tribo)\n#     }\n#   }\n# \n#   # Aplicar a função a cada tribo para criar o vetor de rótulos\n#   labels_tribos <- sapply(ordem_tribos, adicionar_asterisco)\n# \n#   # Construir o gráfico\n#   gg <- ggplot(dados_agregados) +\n#     geom_bar(aes(x = ano, y = proporcao, fill = tribo), stat = \"identity\", position = position_stack(reverse = FALSE)) +\n#     geom_text(data = total_individuos_por_ano, aes(x = ano, y = 100, label = total), vjust = -0.5, size = 3, hjust = 0.5)+\n#     scale_y_continuous(labels = scales::number_format(scale = 1, accuracy = 1), limits = c(0, 100))+\n#     scale_x_discrete(expand = c(0, 0)) +\n#     scale_fill_manual(values = cores_tribos,\n#                       labels = labels_tribos,\n#                       breaks = ordem_tribos) +\n#     labs(title = titulo,\n#          x = \"Ano\",\n#          y = \"Proporção relativa de ocorrência (%)\",\n#          fill = \"Tribo\") +\n#     theme_minimal() +\n#     theme(legend.position = \"right\",\n#           legend.title = element_text(size = 14),\n#           legend.text = element_text(size = 12),\n#           plot.title = element_text(hjust = 0.5, size = 16),\n#           plot.subtitle = element_text(hjust = 0.5, size = 14),\n#           axis.text = element_text(size = 12),\n#           axis.title = element_text(size = 13),\n#           axis.line = element_line(colour = \"gray40\"),\n#           axis.line.x = element_blank()) +\n#     guides(fill = guide_legend(title = \"Tribos\", reverse = FALSE))\n# \n# \n#   # Exibir o gráfico\n#   print(gg)\n# }\n# \n# # Carregar e preparar os dados\n# resultado_final <- read_csv(\"data/resultado_final.csv\")\n# resultado_final$ano <- factor(resultado_final$ano)\n# resultado_final$tribo <- gsub(\"\\\\*\", \"\", resultado_final$tribo)\n# #resultado_final <- resultado_final[resultado_final$ano != \"2023\", ]\n\n\n```\n\n</br>\n\nApesar de termos uma boa representatividade de UCs e um número considerável de borboletas amostradas nos últimos anos, ainda observamos grandes variações nas proporções de tribos entre anos (@fig-regiao-climatica-central-amazonica). Considerando as variações na proporção de indivíduos, enquanto a tribo Brassolini apresentou tendência de diminuição de 2014 a 2017, Epicaliini mostrou tendência oposta. Por outro lado, as tribos Satyrini e Coeini tiveram comportamento errático, variando amplamente entre anos nesse período. Satyrini é a tribo com maior contribuição para o total de indivíduos e uma das que sofrem maiores flutuações. As tribos Callicorini, Biblidini e Ageroniini, características de ambientes alterados, tiveram baixíssima representação no conjunto de UCs da região climática central amazônica. Considerando esse conjunto de variações nas proporções das tribos, a assinatura regional sofreu consideráveis alterações de 2014 a 2018 (@fig-regiao-climatica-central-amazonica). \n\n\n</br>\n\n\n```{r grafico regiao-climatica-central-amazonica}\n#| label: fig-regiao-climatica-central-amazonica\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Padrões de bandas de abundância relativa de tribos de borboletas frugívoras para o período de 2014 a 2022 na região climática central da Amazônia. Números de indivíduos amostrados são indicados sobre as barras verticais.\"\n\n# Definir a região de interesse - colocar as regiões 'norte', 'sudoeste', 'sudeste', 'leste', 'central'\nregiao_interesse <- \"central\"\n\n# Gerar o gráfico para a região de interesse\ngerar_grafico_por_regiao(resultado_final, regiao_interesse)\n\n```\n\n</br>\n\nNão foram coletados dados de borboletas frugívoras em UCs da região climática noroeste amazônica. Essa região é extremamente chuvosa e que praticamente não possui um período de estiagem, dificultando a definição do melhor período de amostragem de borboletas. Mesmo assim, seria importante implementar a amostragem de borboletas em, pelo menos, três EAs da RESEXdo Baixo Juruá, valendo-se dos parâmetros estabelecidos para a região climática norte amazônica (Tabela x). A identificação de ao menos mais duas UCs nessa região para compor o Programa Monitora seria bastante benéfica para conferir maior robustez ao conjunto de dados gerados em nível regional amazônico. \n\nAs outras quatro regiões climáticas amazônicas possuem dois ou três anos a menos de amostragem do que a região Central. Desta forma, considerando o curto tempo de coleta, as análises dos dados dessas regiões ainda são pouco informativas e os resultados gerados não indicam tendências significativas a serem destacadas. \n\nNa região climática norte amazônica três UCs estão sendo amostradas: PARNA Serra da Mocidade, ESEC de Maracá e ESEC Niquiá. As amostragens nessa região começaram em 2017, resultando em menos tempo para definição das frequências normais (@fig-regiao-climatica-norte-amazonica).  \n\n\n</br>\n\n\n```{r grafico regiao-climatica-norte-amazonica}\n#| label: fig-regiao-climatica-norte-amazonica\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Padrões de bandas de abundância relativa de tribos de borboletas frugívoras para o período de 2014 a 2022 na região climática norte da Amazônia. Números de indivíduos amostrados são indicados sobre as barras verticais.\"\n\n# Definir a região de interesse - colocar as regiões 'norte', 'sudoeste', 'sudeste', 'leste', 'central'\nregiao_interesse <- \"norte\"\n\n# Gerar o gráfico para a região de interesse\ngerar_grafico_por_regiao(resultado_final, regiao_interesse)\n\n```\n\n</br>\n\nJá na região climática leste amazônica dados de borboletas frugívoras estão sendo coletados em quatro UCs: PARNA do Cabo Orange, PARNA Montanhas do Tumucumaque, REBIO do Gurupi e RESEXRenascer. A região apresentou menores variações nas proporções de tribos de 2016 a 2022. Essa é uma característica desejável para dados de monitoramento, pois menores variâncias aumentam o poder de discriminação entre amostras (@fig-regiao-climatica-leste-amazonica).  \n\n\n</br>\n\n\n```{r grafico regiao-climatica-leste-amazonica}\n#| label: fig-regiao-climatica-leste-amazonica\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Padrões de bandas de abundância relativa de tribos de borboletas frugívoras para o período de 2017 a 2022 na região climática leste da Amazônia. Números de indivíduos amostrados são indicados sobre as barras verticais.\"\n\n# Definir a região de interesse - colocar as regiões 'norte', 'sudoeste', 'sudeste', 'leste', 'central'\nregiao_interesse <- \"leste\"\n\n# Gerar o gráfico para a região de interesse\ngerar_grafico_por_regiao(resultado_final, regiao_interesse)\n\n```\n\n</br>\n\nNa região climática sudoeste amazônica, 13 UCs e 41 EAs foram amostradas até 2022: ESEC Rio Acre, FLONA de Jamari, PARNA da Serra da Cutia, PARNA da Serra do Divisor, PARNA de Pacaás Novos, PARNA Mapinguari, RESEX Arapixi, RESEX Barreiro das Antas, RESEX do Alto Tarauacá, RESEX do Cazumbá-Iracema, RESEX do Rio Cautário, RESEX Rio Ouro Preto e RESEX Riozinho da Liberdade. A região possui um padrão de assinatura de tribos diferente das demais, com maiores proporções das tribos associadas a ambientes perturbados, especialmente Ageroniini. A grande variação na proporção de Satyrini e, em menor grau, Morphini e Brassolini, gerou assinaturas bastante diferentes em anos consecutivos na região. Isso também pode ser um artefato estatístico relacionado ao aumento do número de estações amostrais e de borboletas amostradas no período, uma vez que estas variáveis aumentaram mais de seis vezes nesse período (@fig-regiao-climatica-sudoeste-amazonica).  \n\n\n</br>\n\n\n```{r grafico regiao-climatica-sudoeste-amazonica}\n#| label: fig-regiao-climatica-sudoeste-amazonica\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Padrões de bandas de abundância relativa de tribos de borboletas frugívoras para o período de 2014 a 2022 na região climática sudoeste da Amazônia. Números de indivíduos amostrados são indicados sobre as barras verticais.\"\n\n# Definir a região de interesse - colocar as regiões 'norte', 'sudoeste', 'sudeste', 'leste', 'central'\nregiao_interesse <- \"sudoeste\"\n\n# Gerar o gráfico para a região de interesse\ngerar_grafico_por_regiao(resultado_final, regiao_interesse)\n\n```\n\n\n</br>\n\nNa região climática sudeste amazônica dados de borboletas frugívoras estão coletados em apenas duas UCs: PARNA do Juruena e REBIO do Tapirapé. Apesar da baixa representação, houve grande homogeneidade nos resultados das áreas amostradas, com assinaturas bastante similares. Considerando que a metade sul da ESEC da Terra do Meio encontra-se nessa região, novas EAs que vierem a ser implementadas nessa porção da UC poderão ser adicionadas a esse conjunto regional (@fig-regiao-climatica-sudeste-amazonica). \n\n</br>\n\n```{r grafico regiao-climatica-sudeste-amazonica}\n#| label: fig-regiao-climatica-sudeste-amazonica\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Padrões de bandas de abundância relativa de tribos de borboletas frugívoras para o período de 2016 a 2022 na região climática sudeste da Amazônia. Números de indivíduos amostrados são indicados sobre as barras verticais.\"\n\n# Definir a região de interesse - colocar as regiões 'norte', 'sudoeste', 'sudeste', 'leste', 'central'\nregiao_interesse <- \"sudeste\"\n\n# Gerar o gráfico para a região de interesse\ngerar_grafico_por_regiao(resultado_final, regiao_interesse)\n\n```\n\n</br>\n\n\n\n### Cerrado e Mata Atlântica  \n\n\n\n\n```{r grafico-assinatura-cerrado}\n#| label: fig-regiao-cerrado\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Padrões de bandas de abundância relativa de tribos de borboletas frugívoras para o período de 2014 a 2022 no bioma Cerrado. Números de indivíduos amostrados são indicados sobre as barras verticais.\"\n\n##### Gráficos de dados Borboletas - Protocolo básico - Cerrado\n### Tribos com asterisco estão ausentes no gráfico\n## Script: Isabela Freitas Oliveira\n\n# Função auxiliar para ajustar o título\najustar_titulo <- function(titulo) {\n  palavras <- strsplit(titulo, \" \")[[1]]\n  \n  # Palavras que necessitam de correção de acentuação\n  #correcoes <- list(\n   # \"Cerrado\" = \"Cerrado\")\n  \n}\n\n# Função para gerar o gráfico para cada unidade de conservação\ngerar_grafico_por_bioma <- function(dados, nome_bioma) {\n  # Preparar o título com as novas regras\n  titulo <- gsub(\"_\", \" \", nome_bioma)\n  titulo <- ajustar_titulo(titulo)  # Utilizando a função de ajuste de título aqui\n  \n  # Filtrar os dados para a unidade de conservação atual\n  dados_bioma <- subset(dados, bioma == nome_bioma & bioma == \"Cerrado\")\n  dados_bioma <- dados_bioma[!is.na(dados_bioma$tribo), ] #tirar os dados 'NA' que estão na tribo\n  \n  # Calcular o total de indivíduos por ano para a região atual\n  total_individuos_por_ano <- dados_bioma %>%\n    group_by(ano) %>%\n    summarise(total = sum(soma_individuos), .groups = 'drop')\n  \n  # Agregar dados por ano e tribo\n  dados_agregados <- dados_bioma %>%\n    group_by(ano, tribo) %>%\n    summarize(frequencia = sum(soma_individuos), .groups = 'drop')\n  \n  # Calcular totais e proporções\n  total_por_ano <- dados_agregados %>%\n    group_by(ano) %>%\n    summarize(total = sum(frequencia), .groups = 'drop')\n  \n  dados_agregados <- left_join(dados_agregados, total_por_ano, by = \"ano\") %>%\n    mutate(proporcao = frequencia / total * 100)\n  \n  # Ajustar proporções\n  dados_agregados <- dados_agregados %>%\n    group_by(ano) %>%\n    mutate(diferenca = 100 - sum(proporcao),\n           proporcao_ajustada = ifelse(proporcao == max(proporcao), proporcao + diferenca, proporcao)) %>%\n    ungroup() %>%\n    dplyr::select(-diferenca, -proporcao) %>%\n    rename(proporcao = proporcao_ajustada)\n  \n  # Ordem específica das tribos\n  ordem_tribos <- c(\n    \"Brassolini\", \"Morphini\", \"Haeterini\", \n    \"Preponini\", \"Melanitini\", \"Anaeini\", \n    \"Epicaliini\",\"Epiphilini\", \"Coeini\",\n    \"Satyrini\",\n    \"Callicorini\", \"Biblidini\",\"Ageroniini\"\n  )\n  \n  # Cores correspondentes às tribos - BLINDSAFE colors (3 categorias de verde, 7 categorias de cinza e 3 categorias de marrom)\n  cores_tribos <- c(\n    \"Brassolini\" = \"#35978f\", \"Morphini\" = \"#80cdc1\", \"Haeterini\" = \"#c7eae5\", \n    \"Preponini\" = \"gray65\", \"Melanitini\" = \"gray70\", \"Anaeini\" = \"gray75\", \n    \"Epicaliini\" = \"gray80\", \"Epiphilini\" = \"gray85\", \"Coeini\" = \"gray90\",\n    \"Satyrini\" = \"gray95\",\n    \"Callicorini\" = \"#f6e8c3\", \"Biblidini\" = \"#dfc27d\",\"Ageroniini\" = \"#bf812d\"\n  )\n  \n  # Ajustar a ordem e as cores das tribos com base nas tribos presentes\n  cores_tribos <- cores_tribos[ordem_tribos]\n  \n  # Assegurar que a coluna 'tribo_clean' respeite a ordem definida\n  dados_agregados$tribo <- factor(dados_agregados$tribo, levels = ordem_tribos)\n  \n  # Criar um data frame com a frequência agregada por tribo\n  #frequencias_por_tribo_ano <- aggregate(frequencia ~ tribo + ano, dados_agregados, sum)\n  \n  # Criar um data frame com a frequência agregada por tribo\n  frequencias_por_tribo_ano <- aggregate(frequencia ~ tribo, dados_agregados, sum)\n  \n  # Criar uma função para determinar se um asterisco deve ser adicionado ao nome da tribo\n  adicionar_asterisco <- function(nome_tribo) {\n    # Verificar se existe alguma frequência igual a zero para essa tribo em qualquer ano\n    if (any(frequencias_por_tribo_ano$tribo == nome_tribo & frequencias_por_tribo_ano$frequencia == 0)) {\n      return(paste0(nome_tribo, \"*\"))\n    } else {\n      return(nome_tribo)\n    }\n  }\n  \n  # Aplicar a função a cada tribo para criar o vetor de rótulos\n  labels_tribos <- sapply(ordem_tribos, adicionar_asterisco)\n  \n  # Construir o gráfico\n  gg <- ggplot(dados_agregados) +\n    geom_bar(aes(x = ano, y = proporcao, fill = tribo), stat = \"identity\", position = position_stack(reverse = FALSE)) +\n    geom_text(data = total_individuos_por_ano, aes(x = ano, y = 100, label = total), vjust = -0.5, size = 3, hjust = 0.5)+\n    scale_y_continuous(labels = scales::number_format(scale = 1, accuracy = 1), limits = c(0, 100))+\n    scale_x_discrete(expand = c(0, 0)) +\n    scale_fill_manual(values = cores_tribos, \n                      labels = labels_tribos,\n                      breaks = ordem_tribos) +\n    labs(title = titulo,\n         x = \"Ano\",\n         y = \"Frequência relativa de ocorrência (%)\",\n         fill = \"Tribo\") +\n    theme_minimal() +\n    theme(legend.position = \"right\", \n          legend.title = element_text(size = 12), \n          legend.text = element_text(size = 10), \n          plot.title = element_text(hjust = 0.5, size = 16), \n          plot.subtitle = element_text(hjust = 0.5, size = 12),\n          axis.text = element_text(size = 12), \n          axis.title = element_text(size = 12),\n          axis.ticks.y = element_line(color = \"black\"),\n          axis.line = element_line(colour = \"gray40\"),\n          axis.line.x = element_blank()) +\n    guides(fill = guide_legend(title = \"Tribos\", reverse = FALSE))\n  \n  \n  # Exibir o gráfico\n  print(gg)\n  \n  # Retorna o gráfico para que possa ser salvo externamente\n  return(gg)\n  \n}\n\n# Carregar e preparar os dados\nresultado_final<-read.csv(\"data/resultado_final.csv\", header=T)\nresultado_final$ano <- factor(resultado_final$ano)\nresultado_final$tribo <- gsub(\"\\\\*\", \"\", resultado_final$tribo)\n#resultado_final <- resultado_final[resultado_final$ano != \"2023\", ]\n\n\n# Obter todas as UC's do bioma Cerrado\nbiomas <- unique(resultado_final$bioma[resultado_final$bioma == \"Cerrado\"])\n\n# Aplicar a função\n #lapply(biomas, function(bioma) gerar_grafico_por_bioma(resultado_final, bioma))\n# \n gerar_grafico_por_bioma(resultado_final, biomas)\n\n```\n\n\n</br>\n\n\n\n</br>\n\n\n```{r grafico regiao-mata-atlantica}\n#| label: fig-regiao-mata-atlantica\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Padrões de bandas de abundância relativa de tribos de borboletas frugívoras para o período de 2015 a 2022 no bioma Mata Atlântica. Números de indivíduos amostrados são indicados sobre as barras verticais.\"\n\n##### Gráficos de dados Borboletas - Protocolo básico - Mata Atlantica\n### Tribos com asterisco estão ausentes no gráfico\n## Script: Isabela Freitas Oliveira\n\n# Carregar bibliotecas\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(scales)\nlibrary(tools)\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n# Função auxiliar para ajustar o título\najustar_titulo <- function(titulo) {\n  palavras <- strsplit(titulo, \" \")[[1]]\n  \n  # Palavras que necessitam de correção de acentuação\n  correcoes <- list(\n    \"Mata_Atlantica\" = \"Mata Atlântica\")\n  \n}\n\n# Função para gerar o gráfico para cada unidade de conservação\ngerar_grafico_por_bioma <- function(dados, nome_bioma) {\n  # Preparar o título com as novas regras\n  titulo <- gsub(\"_\", \" \", nome_bioma)\n  titulo <- ajustar_titulo(titulo)  # Utilizando a função de ajuste de título aqui\n  \n  # Filtrar os dados para a unidade de conservação atual\n  dados_bioma <- subset(dados, bioma == nome_bioma & bioma == \"Mata_Atlantica\")\n  dados_bioma <- dados_bioma[!is.na(dados_bioma$tribo), ] #tirar os dados 'NA' que estão na tribo\n  \n  # Calcular o total de indivíduos por ano para a região atual\n  total_individuos_por_ano <- dados_bioma %>%\n    group_by(ano) %>%\n    summarise(total = sum(soma_individuos), .groups = 'drop')\n  \n  # Agregar dados por ano e tribo\n  dados_agregados <- dados_bioma %>%\n    group_by(ano, tribo) %>%\n    summarize(frequencia = sum(soma_individuos), .groups = 'drop')\n  \n  # Calcular totais e proporções\n  total_por_ano <- dados_agregados %>%\n    group_by(ano) %>%\n    summarize(total = sum(frequencia), .groups = 'drop')\n  \n  dados_agregados <- left_join(dados_agregados, total_por_ano, by = \"ano\") %>%\n    mutate(proporcao = frequencia / total * 100)\n  \n  # Ajustar proporções\n  dados_agregados <- dados_agregados %>%\n    group_by(ano) %>%\n    mutate(diferenca = 100 - sum(proporcao),\n           proporcao_ajustada = ifelse(proporcao == max(proporcao), proporcao + diferenca, proporcao)) %>%\n    ungroup() %>%\n    dplyr::select(-diferenca, -proporcao) %>%\n    rename(proporcao = proporcao_ajustada)\n  \n  # Ordem específica das tribos\n  ordem_tribos <- c(\n    \"Brassolini\", \"Morphini\", \"Haeterini\", \n    \"Preponini\", \"Melanitini\", \"Anaeini\", \n    \"Epicaliini\",\"Epiphilini\", \"Coeini\",\n    \"Satyrini\",\n    \"Callicorini\", \"Biblidini\",\"Ageroniini\"\n  )\n  \n  # Cores correspondentes às tribos - BLINDSAFE colors (3 categorias de verde, 7 categorias de cinza e 3 categorias de marrom)\n  cores_tribos <- c(\n    \"Brassolini\" = \"#35978f\", \"Morphini\" = \"#80cdc1\", \"Haeterini\" = \"#c7eae5\", \n    \"Preponini\" = \"gray65\", \"Melanitini\" = \"gray70\", \"Anaeini\" = \"gray75\", \n    \"Epicaliini\" = \"gray80\", \"Epiphilini\" = \"gray85\", \"Coeini\" = \"gray90\",\n    \"Satyrini\" = \"gray95\",\n    \"Callicorini\" = \"#f6e8c3\", \"Biblidini\" = \"#dfc27d\",\"Ageroniini\" = \"#bf812d\"\n  )\n  \n  # Ajustar a ordem e as cores das tribos com base nas tribos presentes\n  cores_tribos <- cores_tribos[ordem_tribos]\n  \n  # Assegurar que a coluna 'tribo_clean' respeite a ordem definida\n  dados_agregados$tribo <- factor(dados_agregados$tribo, levels = ordem_tribos)\n  \n  # Criar um data frame com a frequência agregada por tribo\n  #frequencias_por_tribo_ano <- aggregate(frequencia ~ tribo + ano, dados_agregados, sum)\n  \n  # Criar um data frame com a frequência agregada por tribo\n  frequencias_por_tribo_ano <- aggregate(frequencia ~ tribo, dados_agregados, sum)\n  \n  # Criar uma função para determinar se um asterisco deve ser adicionado ao nome da tribo\n  adicionar_asterisco <- function(nome_tribo) {\n    # Verificar se existe alguma frequência igual a zero para essa tribo em qualquer ano\n    if (any(frequencias_por_tribo_ano$tribo == nome_tribo & frequencias_por_tribo_ano$frequencia == 0)) {\n      return(paste0(nome_tribo, \"*\"))\n    } else {\n      return(nome_tribo)\n    }\n  }\n  \n  # Aplicar a função a cada tribo para criar o vetor de rótulos\n  labels_tribos <- sapply(ordem_tribos, adicionar_asterisco)\n  \n  # Construir o gráfico\n  gg <- ggplot(dados_agregados) +\n    geom_bar(aes(x = ano, y = proporcao, fill = tribo), stat = \"identity\", position = position_stack(reverse = FALSE)) +\n    geom_text(data = total_individuos_por_ano, aes(x = ano, y = 100, label = total), vjust = -0.5, size = 3, hjust = 0.5)+\n    scale_y_continuous(labels = scales::number_format(scale = 1, accuracy = 1), limits = c(0, 100))+\n    scale_x_discrete(expand = c(0, 0)) +\n    scale_fill_manual(values = cores_tribos, \n                      labels = labels_tribos,\n                      breaks = ordem_tribos) +\n    labs(title = titulo,\n         x = \"Ano\",\n         y = \"Frequência relativa de ocorrência (%)\",\n         fill = \"Tribo\") +\n    theme_minimal() +\n    theme(legend.position = \"right\", \n          legend.title = element_text(size = 12), \n          legend.text = element_text(size = 10), \n          plot.title = element_text(hjust = 0.5, size = 16), \n          plot.subtitle = element_text(hjust = 0.5, size = 12),\n          axis.text = element_text(size = 12), \n          axis.title = element_text(size = 12),\n          axis.ticks.y = element_line(color = \"black\"),\n          axis.line = element_line(colour = \"gray40\"),\n          axis.line.x = element_blank()) +\n    guides(fill = guide_legend(title = \"Tribos\", reverse = FALSE))\n  \n  \n  # Exibir o gráfico\n  print(gg)\n}\n\n# Carregar e preparar os dados\nresultado_final<-read.csv(\"data/resultado_final.csv\", header=T)\nresultado_final$ano <- factor(resultado_final$ano)\nresultado_final$tribo <- gsub(\"\\\\*\", \"\", resultado_final$tribo)\n#resultado_final <- resultado_final[resultado_final$ano != \"2023\", ]\n\n# Obter todas as UC's do bioma Cerrado\nbiomas <- unique(resultado_final$bioma[resultado_final$bioma == \"Mata_Atlantica\"])\n\n# Aplicar a função\ngraficos<-lapply(biomas, function(bioma) gerar_grafico_por_bioma(resultado_final, bioma))\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"MA.png\",  # Escolha um nome adequado para o arquivo\n#        plot = graficos[[1]],  # Especifique qual gráfico da lista deseja salvar\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Tribos por Ano/Relatório/Regional\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 10, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n\n</br>\n\n\n### Índice de abundância de tribos\n\n</br>\n\n\nA análise a seguir está em fase de teste conceitual, tanto do modelo estatístico quanto do significado biológico. Esse tipo de análise geralmente é feito com dados populacionais (abundância de indivíduos), estando seu cálculo e seu significado biológico já consagrados em diversos países (e.g., @Van_2019). Assim, nessa abordagem criamos um índice de abundância aplicável em nível de tribo e geramos análises para testar a sua viabilidade para o Programa Monitora. Caso adotado, esse índice poderá servir de base para o monitoramento de flutuações de abundância, complementando a abordagem das assinaturas, que tem um enfoque qualitativo. Entendemos que o Programa Monitora necessita de abordagens mais quantitativas, que possibilitem a mensuração e definição de níveis de variação sobre os quais possam ser gerados alertas para atenção ou verificação pela gestão da UC. \n\n</br>\n\n#### Cálculo do índice  \n\n</br>\n\nO índice de abundância tem como base o número acumulado de indivíduos de cada tribo em cada ano numa dada área. Partindo da frequência absoluta de indivíduos por tribo por ano (*n*), fazemos inicialmente uma correção, somando um número muito pequeno a cada frequência absoluta, de forma a evitar a presença de zeros na matriz. Desta forma é obtida a frequência absoluta corrigida (*f* = *n* + 0,00001). Em seguida, é calculada a frequência, corrigida pelo esforço amostral (*fe* = número de armadilhas * dias de amostragem). Considerando que essa frequência mostra grandes variações, às vezes em duas ordens de grandeza, optamos por realizar uma transformação logarítmica para normalizar os dados. Assim, o próximo passo é calcular o *log10* da *fe*. O índice é finalmente calculado, comparando-se as variações da fe em anos consecutivos, considerando-se sempre o índice igual a 1,0 para o primeiro ano em que aquela “população” foi registrada. A Tabela x mostra o produto desse cálculo. Note que o ano base para algumas tribos difere do ano base da maioria das outras. \n\n\n</b>\n\n\n\nTabela x. Matriz resultante do cálculo das frequências absolutas divididas pelo esforço amostral, normalizadas (Log10) e transformadas em índice \"populacional\" para rastrear as variações a partir do ano em que uma \"população\" foi detectada (*i* = 1,000); *i* = índice de abundância a partir do ano base.\n\n</br>\n\n\n### Análises regionais\n\n</br>\n\nAssim como foi feito na seção anterior, utilizaremos os mesmos conjuntos de dados regionais para explorar a viabilidade do uso do índice proposto. A região climática central foi analisada separadamente por ser a única que possui dados para cinco anos consecutivos. Apesar de tanto a composição de UCs quanto o esforço amostral terem se multiplicado cinco vezes nesse período (Tabela x), ainda assim este é o melhor conjunto de dados que possuímos para gerar tais análises. \n\nConsiderando que a visualização das 13 tribos em um mesmo gráfico impede a identificação do comportamento das curvas individualmente, optamos por apresentar dois gráficos para cada região, com as tribos mais representativas de ambientes bem preservados e de ambientes mais perturbados. As variações do índice para cada uma dessas tribos para a região climática central amazônica podem ser observadas na @fig-IA-regiao-climatica-central-amazonica-graficos-juntos, @fig-IA-regiao-climatica-sudeste-amazonica-graficos-juntos. O ano base mostra o valor inicial da “população” monitorada e é sempre igual a 1,0. As mudanças subsequentes mostram variações baseadas nessa população inicial, sendo que variações acima da linha de base indicam crescimento populacional e, abaixo, diminuição. Quase todas as tribos apresentaram o mesmo padrão de variação. Houve uma pequena diminuição em 2015 e 2016, seguida de um grande aumento em 2017 e um decréscimo posterior em 2018. É interessante observar que a tribo que apresentou menor variação no período foi Ageroniini, seguida de Morphini. \n\nJá para as demais regiões climáticas amazônicas, o esforço amostral e a quantidade de dados obtidos até 2022 foram inferiores aos obtidos para a região central, sendo ainda insuficientes para mostrar alterações significativas. A região norte passou a gerar dados apenas a partir de 2017 e ainda possui EAs suficientes para possibilitar essa análise. As regiões leste e sudoeste já possuem um bom número de EAs e, em poucos anos, terão dados suficientes para análise. A região sudeste ainda está em processo de implementação, sendo necessária a adesão de novas UCs ao Programa para a obtenção de um conjunto de dados adequado para análise. Essa região vem apresentando os melhores retornos de captura por unidade de esforço (CPUE), com muito mais indivíduos amostrados do que as outras regiões para um mesmo nível de esforço realizado (Tabela x), exceto pela região central (Tabela x). \n\nA abundância das tribos variou sem uma tendência predominante de 2016 a 2018 nas regiões climáticas norte, leste, sudoeste e sudeste amazônicas. Algumas tribos apresentaram picos de abundância para cima ou para baixo durante esses primeiros anos, como Callicorini, na região sudoeste, em 2017, e Biblidini, nas regiões leste e sudeste, também em 2017. Porém, a maioria das tribos encontravam-se, em 2018, próximas do valor original (1,0) (Figura x). Essas tribos apresentaram tamanhos populacionais muito pequenos em quase todas as UCs durante esse período. \n\nDe forma geral, qualquer variação na quantidade de borboletas capturadas causou grandes variações no índice de abundância. Portanto, concluímos que o uso desse índice para “populações” pequenas não é aconselhável. Cabe avaliar se, com o aumento no esforço amostral e uma suposta ampliação na quantidade de dados acumulados, com reflexos no tamanho das populações analisadas, o método nos permitirá discriminar entre variações biologicamente significativas, associadas a algum tipo de alteração ambiental, de meras pequenas oscilações naturais casuais e erráticas nessas populações. \n\n</br>\n\n\nTabela x. Soma do número de indivíduos e esforço amostral (nº de EAs x nº de armadilhas x 12 dias de amostragem) no conjunto de sete UCs da região climática central amazônica. Esforço amostral em armadilhas x dia.\n\n\n</br>\n\n\n```{r grafico IA-regiao-climatica-central-amazonica-calculos}\n#| label: fig-IA-regiao-climatica-central-amazonica\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n\n\n##### Índices de abundância de tribos ao longo dos anos - Amazonia central\n## Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(scales)\nlibrary(vegan)\n\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\ndf_indice<-read.csv(\"data/resultado_final_com_esforco.csv\", header=T, sep = ';') # dataframe para fazer os gráficos\ndf_indice <- df_indice[!is.na(df_indice$tribo), ]\n\ndados_regiao_especifica <- df_indice %>%\n  filter(bioma == \"Amazonia\", regiao == \"central\")\n\n# Agregar soma_individuos por tribo e ano\nsoma_individuos_por_tribo_ano <- dados_regiao_especifica %>%\n  filter(soma_individuos > 0 ) %>%\n  group_by(tribo, ano) %>%\n  summarize(soma_individuos = sum(soma_individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Verificar o esforço individual por uc_ea e expedicao\nesforco_individual <- dados_regiao_especifica %>%\n  group_by(uc, uc_ea, ano, expedicao) %>%\n  summarize(esforco_individual = unique(esforco_amostral), na.rm = TRUE) %>%\n  ungroup()\n\n# Somar os esforços por expedicao\nesforco_por_expedicao <- esforco_individual %>%\n  group_by(uc, ano, expedicao) %>%\n  summarize(esforco_total_expedicao = sum(esforco_individual, na.rm = TRUE)) %>%\n  ungroup()\n\n# Calcular o esforço total anual para cada ano\nesforco_total_anual <- esforco_por_expedicao %>%\n  group_by(ano) %>%\n  summarize(esforco_total_anual = sum(esforco_total_expedicao, na.rm = TRUE)) %>%\n  ungroup()\n\n# Juntar com soma_individuos_por_tribo_ano\ndf_agregado <- soma_individuos_por_tribo_ano %>%\n  left_join(esforco_total_anual, by = \"ano\") %>%\n  ungroup()\n\n# Calcular o índice de abundância\ndf_agregado <- df_agregado %>%\n  mutate(frequencia_corrigida = (soma_individuos + 0.00001) / esforco_total_anual,\n         log_frequencia_corrigida = log10(frequencia_corrigida)) %>%\n  group_by(tribo) %>%\n  arrange(ano) %>%\n  mutate(indice_abundancia = if_else(row_number() == 1, 1, \n                                     log_frequencia_corrigida / lag(log_frequencia_corrigida))) %>%\n  ungroup()\n\n# Reestruturar para visualização\ndf_tribo_ano_largo <- df_agregado %>%\n  pivot_wider(names_from = ano, values_from = indice_abundancia)\n\n# Reestruturar o dataframe para o formato largo # tabela geral dos índices\ndf_tribo_ano_largo <- df_agregado %>%\n  select(tribo, ano, indice_abundancia) %>% # Selecionar as colunas relevantes\n  pivot_wider(names_from = ano, values_from = indice_abundancia) # Transformar para o formato largo\n\n# Limitar os valores a 3 casas decimais\ndf_tribo_ano_largo <- df_tribo_ano_largo %>%\n  mutate_if(is.numeric, ~ round(., 3))\n#write.csv(df_tribo_ano_largo, \"tabela_índice_tribo_ano_AM_Central.csv\", row.names = FALSE)\n\n```\n\n\n\n\n\n```{r fig-IA-regiao-climatica-central-amazonica-floresta}\n#| label: fig-IA-regiao-climatica-central-amazonica-floresta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática central da Amazônia, no período de 2014 a 2022.\"\n\n############\n#Gráficos\nlibrary(ggplot2)\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Brassolini\" = \"#003C30\", \"Morphini\" = \"#23867E\", \"Haeterini\" = \"#97D6CD\")\ntipos_linhas <- c(\"Brassolini\" = \"solid\", \"Morphini\" = \"dashed\", \"Haeterini\" = \"twodash\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Brassolini\", \"Morphini\", \"Haeterini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Brassolini\", \"Morphini\", \"Haeterini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Brassolini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Morphini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_florestal <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_color_manual(values = cores_linhas) +\n  scale_y_continuous(limits = c(0, 2))+\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"Região Climática Central Amazônica\",\n       subtitle = \"Borboletas de áreas fechadas\",\n       x = \"Ano\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n   theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_florestal)\n\n# Salvar a imagem usando ggsave()\n#ggsave(filename = \"indice de abundancia AM_Central_florestal_linhas_.png\",  # Escolha um nome adequado para o arquivo\n #      plot = gg_florestal,  # O objeto ggplot\n  #     device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n   #    path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n    #   dpi = 300,  # Define a resolução (DPI)\n     #  width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n\n\n\n\n```{r fig-IA-regiao-climatica-central-amazonica-areas-abertas}\n#| label: fig-IA-regiao-climatica-central-amazonica-areas-abertas\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática central da Amazônia, no período de 2014 a 2022.\"\n\n#Gráficos Borboletas de areas abertas\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Callicorini\" = \"#CFA154\", \"Biblidini\" = \"#824B09\", \"Ageroniini\" = \"#543005\")\ntipos_linhas <- c(\"Callicorini\" = \"twodash\", \"Biblidini\" = \"dashed\", \"Ageroniini\" = \"solid\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Ageroniini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Biblidini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_aberto <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0, 2.0))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"\",\n       subtitle = \"Borboletas de áreas abertas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_aberto)\n\n# Salvar a imagem usando ggsave()\n#ggsave(filename = \"indice de abundancia_AM_Central_aberto_linhas_.png\",  # Escolha um nome adequado para o arquivo\n #      plot = gg_aberto,  # O objeto ggplot\n  ##     device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n    #   path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n     #  dpi = 300,  # Define a resolução (DPI)\n      # width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n\n\n```\n\n\n\n\n```{r fig-IA-regiao-climatica-central-amazonica-graficos-juntos}\n#| label: fig-IA-regiao-climatica-central-amazonica-graficos-juntos\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática central da Amazônia, no período de 2014 a 2022.\"\n\n######\n#Gráficos juntos\nlibrary(gridExtra)\n# Gráficos combinados\ng <- grid.arrange(gg_florestal, gg_aberto, ncol = 1, heights = c(3, 3))\n\n# ggsave(\"graficos_combinados_indice_AM_Central_linhas.png\", \n#        grid.arrange(gg_florestal, gg_aberto, ncol = 1, heights = c(3,3)), \n#        device = \"png\", \n#        width = 12, height = 10, units = \"in\", \n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n\n\n#knitr::include_graphics(\"imagens/cap04/bo_IA_regiao_climatica_central_amazonica.JPG\")\n\n```\n\n\n</br>\n\n\n```{r grafico IA-regiao-climatica-norte-amazonica-calculo}\n#| label: fig-IA-regiao-climatica-norte-amazonica-calculo\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n\n##### Índices de abundância de tribos ao longo dos anos - Amazonia Norte\n## Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\n\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\ndf_indice<-read.csv(\"data/resultado_final_com_esforco.csv\", header=T, sep = ';') # dataframe para fazer os gráficos\ndf_indice <- df_indice[!is.na(df_indice$tribo), ]\n\ndados_regiao_especifica <- df_indice %>%\n  filter(bioma == \"Amazonia\", regiao == \"norte\")\n\n# Agregar soma_individuos por tribo e ano\nsoma_individuos_por_tribo_ano <- dados_regiao_especifica %>%\n  filter(soma_individuos > 0 ) %>%\n  group_by(tribo, ano) %>%\n  summarize(soma_individuos = sum(soma_individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Verificar o esforço individual por uc_ea e expedicao\nesforco_individual <- dados_regiao_especifica %>%\n  group_by(uc, uc_ea, ano, expedicao) %>%\n  summarize(esforco_individual = unique(esforco_amostral), na.rm = TRUE) %>%\n  ungroup()\n\n# Somar os esforços por expedicao\nesforco_por_expedicao <- esforco_individual %>%\n  group_by(uc, ano, expedicao) %>%\n  summarize(esforco_total_expedicao = sum(esforco_individual, na.rm = TRUE)) %>%\n  ungroup()\n\n# Calcular o esforço total anual para cada ano\nesforco_total_anual <- esforco_por_expedicao %>%\n  group_by(ano) %>%\n  summarize(esforco_total_anual = sum(esforco_total_expedicao, na.rm = TRUE)) %>%\n  ungroup()\n\n# Juntar com soma_individuos_por_tribo_ano\ndf_agregado <- soma_individuos_por_tribo_ano %>%\n  left_join(esforco_total_anual, by = \"ano\") %>%\n  ungroup()\n\n# Calcular o índice de abundância\ndf_agregado <- df_agregado %>%\n  mutate(frequencia_corrigida = (soma_individuos + 0.00001) / esforco_total_anual,\n         log_frequencia_corrigida = log10(frequencia_corrigida)) %>%\n  group_by(tribo) %>%\n  arrange(ano) %>%\n  mutate(indice_abundancia = if_else(row_number() == 1, 1, \n                                     log_frequencia_corrigida / lag(log_frequencia_corrigida))) %>%\n  ungroup()\n\n# Reestruturar para visualização\ndf_tribo_ano_largo <- df_agregado %>%\n  pivot_wider(names_from = ano, values_from = indice_abundancia)\n\n# Reestruturar o dataframe para o formato largo # tabela geral dos índices\ndf_tribo_ano_largo <- df_agregado %>%\n  select(tribo, ano, indice_abundancia) %>% # Selecionar as colunas relevantes\n  pivot_wider(names_from = ano, values_from = indice_abundancia) # Transformar para o formato largo\n\n# Limitar os valores a 3 casas decimais\ndf_tribo_ano_largo <- df_tribo_ano_largo %>%\n  mutate_if(is.numeric, ~ round(., 3))\n#write.csv(df_tribo_ano_largo, \"tabela_índice_tribo_ano_MataAtlantica.csv\", row.names = FALSE)\n\n```\n\n\n\n\n```{r grafico IA-regiao-climatica-norte-amazonica-floresta}\n#| label: fig-IA-regiao-climatica-norte-amazonica-floresta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática norte da Amazônia, no período de 2014 a 2022.\"\n\n\n############\n#Gráficos\nlibrary(ggplot2)\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Brassolini\" = \"#003C30\", \"Morphini\" = \"#23867E\", \"Haeterini\" = \"#97D6CD\")\ntipos_linhas <- c(\"Brassolini\" = \"solid\", \"Morphini\" = \"dashed\", \"Haeterini\" = \"twodash\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Brassolini\", \"Morphini\", \"Haeterini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Brassolini\", \"Morphini\", \"Haeterini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Brassolini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Morphini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_florestal <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0.5, 1.5))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"Região Climática Norte Amazônica\",\n       subtitle = \"Borboletas de áreas fechadas\",\n       x = \"Ano\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_florestal)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia AM_Norte_florestal_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_florestal,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n######\n```\n\n\n\n\n```{r grafico IA-regiao-climatica-norte-amazonica-area-aberta}\n#| label: fig-IA-regiao-climatica-norte-amazonica-area-aberta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática norte da Amazônia, no período de 2014 a 2022.\"\n\n#Gráficos Borboletas de areas abertas\n\n# Definir as cores e tipos de linha para cada tribo # norte nao tem biblidinae\ncores_linhas <- c(\"Callicorini\" = \"#CFA154\", \"Ageroniini\" = \"#543005\")\ntipos_linhas <- c(\"Callicorini\" = \"twodash\", \"Ageroniini\" = \"solid\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Callicorini\", \"Ageroniini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Callicorini\", \"Ageroniini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Ageroniini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Callicorini\",\"dotted\", \"twodash\"))\n\n# Crie o gráfico\ngg_aberto <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0.5,1.5))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"\",\n       subtitle = \"Borboletas de áreas abertas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_aberto) #callicorini só tem 1 registro em 2022, por isso nao tem linha\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia_AM_Norte_aberto_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_aberto,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n\n```\n\n\n```{r grafico IA-regiao-climatica-norte-amazonica-graficos-juntos}\n#| label: fig-IA-regiao-climatica-norte-amazonica-area-aberta-graficos-juntos\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática norte da Amazônia, no período de 2014 a 2022.\"\n\n#Gráficos juntos\nlibrary(gridExtra)\n\ngrid.arrange(gg_florestal, gg_aberto, ncol = 1, heights = c(3,3))\n# ggsave(\"graficos_combinados_indice_AM_Norte_linhas.png\", \n#        grid.arrange(gg_florestal, gg_aberto, ncol = 1, heights = c(3,3)), \n#        device = \"png\", \n#        width = 12, height = 10, units = \"in\", \n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n\n# knitr::include_graphics(\"imagens/cap04/bo_IA_areas_abertas_regiao_climatica_norte_amazonica.JPG\")\n\n```\n\n</b>\n\n```{r grafico IA-regiao-climatica-leste-amazonica-calculo}\n#| label: fig-IA-regiao-climatica-leste-amazonica-calculo\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n\n\n##### Índices de abundância de tribos ao longo dos anos - Mata Atlântica\n## Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\n\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\ndf_indice<-read.csv(\"data/resultado_final_com_esforco.csv\", header=T, sep = ';') # dataframe para fazer os gráficos\ndf_indice <- df_indice[!is.na(df_indice$tribo), ]\n\ndados_regiao_especifica <- df_indice %>%\n  filter(bioma == \"Amazonia\", regiao == \"leste\")\n\n# Agregar soma_individuos por tribo e ano\nsoma_individuos_por_tribo_ano <- dados_regiao_especifica %>%\n  filter(soma_individuos > 0 ) %>%\n  group_by(tribo, ano) %>%\n  summarize(soma_individuos = sum(soma_individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Verificar o esforço individual por uc_ea e expedicao\nesforco_individual <- dados_regiao_especifica %>%\n  group_by(uc, uc_ea, ano, expedicao) %>%\n  summarize(esforco_individual = unique(esforco_amostral), na.rm = TRUE) %>%\n  ungroup()\n\n# Somar os esforços por expedicao\nesforco_por_expedicao <- esforco_individual %>%\n  group_by(uc, ano, expedicao) %>%\n  summarize(esforco_total_expedicao = sum(esforco_individual, na.rm = TRUE)) %>%\n  ungroup()\n\n# Calcular o esforço total anual para cada ano\nesforco_total_anual <- esforco_por_expedicao %>%\n  group_by(ano) %>%\n  summarize(esforco_total_anual = sum(esforco_total_expedicao, na.rm = TRUE)) %>%\n  ungroup()\n\n# Juntar com soma_individuos_por_tribo_ano\ndf_agregado <- soma_individuos_por_tribo_ano %>%\n  left_join(esforco_total_anual, by = \"ano\") %>%\n  ungroup()\n\n# Calcular o índice de abundância\ndf_agregado <- df_agregado %>%\n  mutate(frequencia_corrigida = (soma_individuos + 0.00001) / esforco_total_anual,\n         log_frequencia_corrigida = log10(frequencia_corrigida)) %>%\n  group_by(tribo) %>%\n  arrange(ano) %>%\n  mutate(indice_abundancia = if_else(row_number() == 1, 1, \n                                     log_frequencia_corrigida / lag(log_frequencia_corrigida))) %>%\n  ungroup()\n\n# Reestruturar para visualização\ndf_tribo_ano_largo <- df_agregado %>%\n  pivot_wider(names_from = ano, values_from = indice_abundancia)\n\n# Reestruturar o dataframe para o formato largo # tabela geral dos índices\ndf_tribo_ano_largo <- df_agregado %>%\n  select(tribo, ano, indice_abundancia) %>% # Selecionar as colunas relevantes\n  pivot_wider(names_from = ano, values_from = indice_abundancia) # Transformar para o formato largo\n\n# Limitar os valores a 3 casas decimais\ndf_tribo_ano_largo <- df_tribo_ano_largo %>%\n  mutate_if(is.numeric, ~ round(., 3))\n#write.csv(df_tribo_ano_largo, \"tabela_índice_tribo_ano_MataAtlantica.csv\", row.names = FALSE)\n\n\n```\n\n\n\n```{r grafico IA-regiao-climatica-leste-amazonica-floresta}\n#| label: fig-IA-regiao-climatica-leste-amazonica-floresta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática leste da Amazônia, no período de 2014 a 2022.\"\n\n#Gráficos\nlibrary(ggplot2)\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Brassolini\" = \"#003C30\", \"Morphini\" = \"#23867E\", \"Haeterini\" = \"#97D6CD\")\ntipos_linhas <- c(\"Brassolini\" = \"solid\", \"Morphini\" = \"dashed\", \"Haeterini\" = \"twodash\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Brassolini\", \"Morphini\", \"Haeterini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Brassolini\", \"Morphini\", \"Haeterini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Brassolini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Morphini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_florestal <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0.5, 2.0))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"Região Climática Leste Amazônica\",\n       subtitle = \"Borboletas de áreas fechadas\",\n       x = \"Ano\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_florestal)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia AM_Leste_florestal_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_florestal,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n\n\n```{r grafico IA-regiao-climatica-leste-amazonica-area-aberta}\n#| label: fig-IA-regiao-climatica-leste-amazonica-area-aberta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática leste da Amazônia, no período de 2014 a 2022.\"\n\n######\n#Gráficos Borboletas de areas abertas\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Callicorini\" = \"#CFA154\", \"Biblidini\" = \"#824B09\", \"Ageroniini\" = \"#543005\")\ntipos_linhas <- c(\"Callicorini\" = \"twodash\", \"Biblidini\" = \"dashed\", \"Ageroniini\" = \"solid\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Ageroniini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Biblidini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_aberto <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0.5, 2.0))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"\",\n       subtitle = \"Borboletas de áreas abertas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_aberto)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia_AM_Leste_aberto_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_aberto,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n\n```\n\n\n\n```{r grafico IA-regiao-climatica-leste-amazonica-graficos-juntos}\n#| label: fig-IA-regiao-climatica-leste-amazonica-graficos-juntos\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática leste da Amazônia, no período de 2014 a 2022.\"\n\n######\n#Gráficos juntos\nlibrary(gridExtra)\n\ngrid.arrange(gg_florestal, gg_aberto, ncol = 1,  heights = c(3,3))\n# ggsave(\"graficos_combinados_indice_AM_Leste_linhas.png\", \n#        grid.arrange(gg_florestal, gg_aberto, ncol = 1,  heights = c(3,3)), \n#        device = \"png\", \n#        width = 12, height = 10, units = \"in\", \n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n#knitr::include_graphics(\"imagens/cap04/bo_IA_areas_abertas_regiao_climatica_leste_amazonica.JPG\")\n\n```\n\n</br>\n\n\n```{r grafico IA-regiao-climatica-sudoeste-amazonica-calculo}\n#| label: fig-IA-regiao-climatica-sudoeste-amazonica-calculo\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n\n##### Índices de abundância de tribos ao longo dos anos - Sudoeste Amazônico\n## Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\n\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\ndf_indice<-read.csv(\"data/resultado_final_com_esforco.csv\", header=T, sep = ';') # dataframe para fazer os gráficos\ndf_indice <- df_indice[!is.na(df_indice$tribo), ]\n\ndados_regiao_especifica <- df_indice %>%\n  filter(bioma == \"Amazonia\", regiao == \"sudoeste\")\n\n# Agregar soma_individuos por tribo e ano\nsoma_individuos_por_tribo_ano <- dados_regiao_especifica %>%\n  filter(soma_individuos > 0 ) %>%\n  group_by(tribo, ano) %>%\n  summarize(soma_individuos = sum(soma_individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Verificar o esforço individual por uc_ea e expedicao\nesforco_individual <- dados_regiao_especifica %>%\n  group_by(uc, uc_ea, ano, expedicao) %>%\n  summarize(esforco_individual = unique(esforco_amostral), na.rm = TRUE) %>%\n  ungroup()\n\n# Somar os esforços por expedicao\nesforco_por_expedicao <- esforco_individual %>%\n  group_by(uc, ano, expedicao) %>%\n  summarize(esforco_total_expedicao = sum(esforco_individual, na.rm = TRUE)) %>%\n  ungroup()\n\n# Calcular o esforço total anual para cada ano\nesforco_total_anual <- esforco_por_expedicao %>%\n  group_by(ano) %>%\n  summarize(esforco_total_anual = sum(esforco_total_expedicao, na.rm = TRUE)) %>%\n  ungroup()\n\n# Juntar com soma_individuos_por_tribo_ano\ndf_agregado <- soma_individuos_por_tribo_ano %>%\n  left_join(esforco_total_anual, by = \"ano\") %>%\n  ungroup()\n\n# Calcular o índice de abundância\ndf_agregado <- df_agregado %>%\n  mutate(frequencia_corrigida = (soma_individuos + 0.00001) / esforco_total_anual,\n         log_frequencia_corrigida = log10(frequencia_corrigida)) %>%\n  group_by(tribo) %>%\n  arrange(ano) %>%\n  mutate(indice_abundancia = if_else(row_number() == 1, 1, \n                                     log_frequencia_corrigida / lag(log_frequencia_corrigida))) %>%\n  ungroup()\n\n# Reestruturar para visualização\ndf_tribo_ano_largo <- df_agregado %>%\n  pivot_wider(names_from = ano, values_from = indice_abundancia)\n\n# Reestruturar o dataframe para o formato largo # tabela geral dos índices\ndf_tribo_ano_largo <- df_agregado %>%\n  select(tribo, ano, indice_abundancia) %>% # Selecionar as colunas relevantes\n  pivot_wider(names_from = ano, values_from = indice_abundancia) # Transformar para o formato largo\n\n# Limitar os valores a 3 casas decimais\ndf_tribo_ano_largo <- df_tribo_ano_largo %>%\n  mutate_if(is.numeric, ~ round(., 3))\n#write.csv(df_tribo_ano_largo, \"tabela_índice_tribo_ano_AM_sudoeste.csv\", row.names = FALSE)\n```\n\n\n\n```{r grafico IA-regiao-climatica-sudoeste-amazonica-floresta}\n#| label: fig-IA-regiao-climatica-sudoeste-amazonica-floresta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática norte da Amazônia, no período de 2014 a 2022.\"\n\n#Gráficos\nlibrary(ggplot2)\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Brassolini\" = \"#003C30\", \"Morphini\" = \"#23867E\", \"Haeterini\" = \"#97D6CD\")\ntipos_linhas <- c(\"Brassolini\" = \"solid\", \"Morphini\" = \"dashed\", \"Haeterini\" = \"twodash\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Brassolini\", \"Morphini\", \"Haeterini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Brassolini\", \"Morphini\", \"Haeterini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Brassolini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Morphini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_florestal <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0, 1.5)) +\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"Região Climática Sudoeste Amazônica\",\n       subtitle = \"Borboletas de áreas fechadas\",\n       x = \"Ano\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_florestal)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia AM_Sudoeste_florestal_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_florestal,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n\n```{r grafico IA-regiao-climatica-sudoeste-amazonica-area-aberta}\n#| label: fig-IA-regiao-climatica-sudoeste-amazonica-area-aberta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática norte da Amazônia, no período de 2014 a 2022.\"\n\n#Gráficos Borboletas de areas abertas\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Callicorini\" = \"#CFA154\", \"Biblidini\" = \"#824B09\", \"Ageroniini\" = \"#543005\")\ntipos_linhas <- c(\"Callicorini\" = \"twodash\", \"Biblidini\" = \"dashed\", \"Ageroniini\" = \"solid\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Ageroniini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Biblidini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_aberto <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo))+\n  scale_y_continuous(limits = c(0, 1.5))+\n  geom_line(size = 0.7) +\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"\",\n       subtitle = \"Borboletas de áreas abertas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_aberto)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia_AM_Sudoeste_aberto_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_aberto,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n\n```\n\n\n\n```{r grafico IA-regiao-climatica-sudoeste-amazonica-graficos-juntos}\n#| label: fig-IA-regiao-climatica-sudoeste-amazonica-graficos-juntos\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática norte da Amazônia, no período de 2014 a 2022.\"\n\n######\n#Gráficos juntos\nlibrary(gridExtra)\n\ngrid.arrange(gg_florestal, gg_aberto, ncol = 1,  heights = c(3,3))\n# ggsave(\"graficos_combinados_indice_AM_Sudoeste_linhas.png\", \n#        grid.arrange(gg_florestal, gg_aberto, ncol = 1, heights = c(3,3)), \n#        device = \"png\", \n#        width = 12, height = 10, units = \"in\", \n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n\n#knitr::include_graphics(\"imagens/cap04/bo_IA_areas_abertas_regiao_climatica_norte_amazonica.JPG\")\n\n```\n\n</br>\n\n\n```{r grafico IA-regiao-climatica-sudeste-amazonica-calculo}\n#| label: fig-IA-regiao-climatica-sudeste-amazonica-calculo\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática sudeste da Amazônia, no período de 2014 a 2022.\"\n\n##### Índices de abundância de tribos ao longo dos anos - Mata Atlântica\n## Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\n\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\ndf_indice<-read.csv(\"data/resultado_final_com_esforco.csv\", header=T, sep = ';') # dataframe para fazer os gráficos\ndf_indice <- df_indice[!is.na(df_indice$tribo), ]\n\ndados_regiao_especifica <- df_indice %>%\n  filter(bioma == \"Amazonia\", regiao == \"sudeste\")\n\n# Agregar soma_individuos por tribo e ano\nsoma_individuos_por_tribo_ano <- dados_regiao_especifica %>%\n  filter(soma_individuos > 0 ) %>%\n  group_by(tribo, ano) %>%\n  summarize(soma_individuos = sum(soma_individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Verificar o esforço individual por uc_ea e expedicao\nesforco_individual <- dados_regiao_especifica %>%\n  group_by(uc, uc_ea, ano, expedicao) %>%\n  summarize(esforco_individual = unique(esforco_amostral), na.rm = TRUE) %>%\n  ungroup()\n\n# Somar os esforços por expedicao\nesforco_por_expedicao <- esforco_individual %>%\n  group_by(uc, ano, expedicao) %>%\n  summarize(esforco_total_expedicao = sum(esforco_individual, na.rm = TRUE)) %>%\n  ungroup()\n\n# Calcular o esforço total anual para cada ano\nesforco_total_anual <- esforco_por_expedicao %>%\n  group_by(ano) %>%\n  summarize(esforco_total_anual = sum(esforco_total_expedicao, na.rm = TRUE)) %>%\n  ungroup()\n\n# Juntar com soma_individuos_por_tribo_ano\ndf_agregado <- soma_individuos_por_tribo_ano %>%\n  left_join(esforco_total_anual, by = \"ano\") %>%\n  ungroup()\n\n# Calcular o índice de abundância\ndf_agregado <- df_agregado %>%\n  mutate(frequencia_corrigida = (soma_individuos + 0.00001) / esforco_total_anual,\n         log_frequencia_corrigida = log10(frequencia_corrigida)) %>%\n  group_by(tribo) %>%\n  arrange(ano) %>%\n  mutate(indice_abundancia = if_else(row_number() == 1, 1, \n                                     log_frequencia_corrigida / lag(log_frequencia_corrigida))) %>%\n  ungroup()\n\n# Reestruturar para visualização\ndf_tribo_ano_largo <- df_agregado %>%\n  pivot_wider(names_from = ano, values_from = indice_abundancia)\n\n# Reestruturar o dataframe para o formato largo # tabela geral dos índices\ndf_tribo_ano_largo <- df_agregado %>%\n  select(tribo, ano, indice_abundancia) %>% # Selecionar as colunas relevantes\n  pivot_wider(names_from = ano, values_from = indice_abundancia) # Transformar para o formato largo\n\n# Limitar os valores a 3 casas decimais\ndf_tribo_ano_largo <- df_tribo_ano_largo %>%\n  mutate_if(is.numeric, ~ round(., 3))\n#write.csv(df_tribo_ano_largo, \"tabela_índice_tribo_ano_AM_sudeste.csv\", row.names = FALSE)\n\n\n```\n\n\n\n\n```{r grafico IA-regiao-climatica-sudeste-amazonica-floresta}\n#| label: fig-IA-regiao-climatica-sudeste-amazonica-floresta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática sudeste da Amazônia, no período de 2014 a 2022.\"\n\n############\n#Gráficos\nlibrary(ggplot2)\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Brassolini\" = \"#003C30\", \"Morphini\" = \"#23867E\", \"Haeterini\" = \"#97D6CD\")\ntipos_linhas <- c(\"Brassolini\" = \"solid\", \"Morphini\" = \"dashed\", \"Haeterini\" = \"twodash\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Brassolini\", \"Morphini\", \"Haeterini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Brassolini\", \"Morphini\", \"Haeterini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Brassolini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Morphini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_florestal <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0.5, 2.0))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"Região Climática Sudeste Amazônica\",\n       subtitle = \"Borboletas de áreas fechadas\",\n       x = \"Ano\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_florestal)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia AM_Sudeste_florestal_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_florestal,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n\n```{r grafico IA-regiao-climatica-sudeste-amazonica-area-aberta}\n#| label: fig-IA-regiao-climatica-sudeste-amazonica-area-aberta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática sudeste da Amazônia, no período de 2014 a 2022.\"\n\n#Gráficos Borboletas de areas abertas\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Callicorini\" = \"#CFA154\", \"Biblidini\" = \"#824B09\", \"Ageroniini\" = \"#543005\")\ntipos_linhas <- c(\"Callicorini\" = \"twodash\", \"Biblidini\" = \"dashed\", \"Ageroniini\" = \"solid\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Ageroniini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Biblidini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_aberto <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0.5, 2.0))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"\",\n       subtitle = \"Borboletas de áreas abertas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_aberto)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia_AM_Sudeste_aberto_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_aberto,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n\n```{r grafico IA-regiao-climatica-sudeste-amazonica-graficos-juntos}\n#| label: fig-IA-regiao-climatica-sudeste-amazonica-graficos-juntos\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) na região climática sudeste da Amazônia, no período de 2014 a 2022.\"\n\n\n######\n#Gráficos juntos\nlibrary(gridExtra)\n\ngrid.arrange(gg_florestal, gg_aberto, ncol = 1,  heights = c(3,3))\n# ggsave(\"graficos_combinados_indice_AM_Sudeste_linhas.png\", \n#        grid.arrange(gg_florestal, gg_aberto,  ncol = 1,  heights = c(3,3)), \n#        device = \"png\", \n#        width = 12, height = 10, units = \"in\", \n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n\n# knitr::include_graphics(\"imagens/cap04/bo_IA_areas_abertas_regiao_climatica_sudeste_amazonica.JPG\")\n\n```\n\n</br>\n\n```{r grafico IA-cerrado-calculo}\n#| label: fig-IA-cerrado-calculo\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) no bioma Cerrado, no período de 2014 a 2022.\"\n\n##### Índices de abundância de tribos ao longo dos anos - Cerrado\n## Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\n\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\ndf_indice<-read.csv(\"data/resultado_final_com_esforco.csv\", header=T, sep = ';') # dataframe para fazer os gráficos\ndf_indice <- df_indice[!is.na(df_indice$tribo), ]\n\ndados_regiao_especifica <- df_indice %>%\n  filter(bioma == \"Cerrado\")\n\n# Agregar soma_individuos por tribo e ano\nsoma_individuos_por_tribo_ano <- dados_regiao_especifica %>%\n  filter(soma_individuos > 0 ) %>%\n  group_by(tribo, ano) %>%\n  summarize(soma_individuos = sum(soma_individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Verificar o esforço individual por uc_ea e expedicao\nesforco_individual <- dados_regiao_especifica %>%\n  group_by(uc, uc_ea, ano, expedicao) %>%\n  summarize(esforco_individual = unique(esforco_amostral), na.rm = TRUE) %>%\n  ungroup()\n\n# Somar os esforços por expedicao\nesforco_por_expedicao <- esforco_individual %>%\n  group_by(uc, ano, expedicao) %>%\n  summarize(esforco_total_expedicao = sum(esforco_individual, na.rm = TRUE)) %>%\n  ungroup()\n\n# Calcular o esforço total anual para cada ano\nesforco_total_anual <- esforco_por_expedicao %>%\n  group_by(ano) %>%\n  summarize(esforco_total_anual = sum(esforco_total_expedicao, na.rm = TRUE)) %>%\n  ungroup()\n\n# Juntar com soma_individuos_por_tribo_ano\ndf_agregado <- soma_individuos_por_tribo_ano %>%\n  left_join(esforco_total_anual, by = \"ano\") %>%\n  ungroup()\n\n# Calcular o índice de abundância\ndf_agregado <- df_agregado %>%\n  mutate(frequencia_corrigida = (soma_individuos + 0.00001) / esforco_total_anual,\n         log_frequencia_corrigida = log10(frequencia_corrigida)) %>%\n  group_by(tribo) %>%\n  arrange(ano) %>%\n  mutate(indice_abundancia = if_else(row_number() == 1, 1, \n                                     log_frequencia_corrigida / lag(log_frequencia_corrigida))) %>%\n  ungroup()\n\n# Reestruturar para visualização\ndf_tribo_ano_largo <- df_agregado %>%\n  pivot_wider(names_from = ano, values_from = indice_abundancia)\n\n# Reestruturar o dataframe para o formato largo # tabela geral dos índices\ndf_tribo_ano_largo <- df_agregado %>%\n  select(tribo, ano, indice_abundancia) %>% # Selecionar as colunas relevantes\n  pivot_wider(names_from = ano, values_from = indice_abundancia) # Transformar para o formato largo\n\n# Limitar os valores a 3 casas decimais\ndf_tribo_ano_largo <- df_tribo_ano_largo %>%\n  mutate_if(is.numeric, ~ round(., 3))\n#write.csv(df_tribo_ano_largo, \"tabela_índice_tribo_ano_MataAtlantica.csv\", row.names = FALSE)\n\n#knitr::include_graphics(\"imagens/cap04/bo_IA_cerrado.JPG\")\n\n```\n\n\n```{r grafico IA-cerrado-floresta}\n#| label: fig-IA-cerrado-floresta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) no bioma Mata Atlântica, no período de 2014 a 2022.\"\n\n\n#Gráficos\nlibrary(ggplot2)\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Brassolini\" = \"#003C30\", \"Morphini\" = \"#23867E\")\ntipos_linhas <- c(\"Brassolini\" = \"solid\", \"Morphini\" = \"dashed\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>% #Nao teve captura de Haeterini\n  filter(tribo %in% c(\"Brassolini\", \"Morphini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Brassolini\", \"Morphini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Brassolini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Morphini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_florestal <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0, 2.5))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"Cerrado\",\n       subtitle = \"Borbletas de áreas fechadas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_florestal)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia Cerrado_florestal_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_florestal,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n```\n\n\n```{r grafico IA-cerrado-area-aberta}\n#| label: fig-IA-cerrado-area-aberta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) no bioma Mata Atlântica, no período de 2014 a 2022.\"\n\n\n#Gráficos Borboletas de areas abertas\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Callicorini\" = \"#CFA154\", \"Biblidini\" = \"#824B09\", \"Ageroniini\" = \"#543005\")\ntipos_linhas <- c(\"Callicorini\" = \"twodash\", \"Biblidini\" = \"dashed\", \"Ageroniini\" = \"solid\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Ageroniini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Biblidini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_aberto <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0, 2.5))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"\",\n       subtitle = \"Borboletas de áreas abertas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico #só tem 1 registro de callicorini, em 2018.\nprint(gg_aberto)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia Cerrado_aberto_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_aberto,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n\n```\n\n</br>\n\n```{r grafico IA-cerrado-juntos}\n#| label: fig-IA-cerrado-juntos\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) no bioma Cerrado, no período de 2014 a 2022.\"\n\n#Gráficos juntos\nlibrary(gridExtra)\n\ngrid.arrange(gg_florestal, gg_aberto, ncol = 1, heights = c(3, 3))\n# ggsave(\"graficos_combinados_indice_Cerrado_linhas.png\", \n#        grid.arrange(gg_florestal, gg_aberto, ncol = 1, heights = c(3, 3)), \n#        device = \"png\", \n#        width = 12, height = 10, units = \"in\", \n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n```\n\n\n\n</br>\n\n\n```{r grafico IA-mata-atlantica-calculo}\n#| label: fig-IA-mata-atlantica-calculo\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) no bioma Mata Atlântica, no período de 2014 a 2022.\"\n\n\n##### Índices de abundância de tribos ao longo dos anos - Mata Atlântica\n## Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\n\n\n# Definir o diretório de trabalho\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\ndf_indice<-read.csv(\"data/resultado_final_com_esforco.csv\", header=T, sep = ';') # dataframe para fazer os gráficos\ndf_indice <- df_indice[!is.na(df_indice$tribo), ]\n\ndados_regiao_especifica <- df_indice %>%\n  filter(bioma == \"Mata_Atlantica\")\n\n# Agregar soma_individuos por tribo e ano\nsoma_individuos_por_tribo_ano <- dados_regiao_especifica %>%\n  filter(soma_individuos > 0 ) %>%\n  group_by(tribo, ano) %>%\n  summarize(soma_individuos = sum(soma_individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Verificar o esforço individual por uc_ea e expedicao\nesforco_individual <- dados_regiao_especifica %>%\n  group_by(uc, uc_ea, ano, expedicao) %>%\n  summarize(esforco_individual = unique(esforco_amostral), na.rm = TRUE) %>%\n  ungroup()\n\n# Somar os esforços por expedicao\nesforco_por_expedicao <- esforco_individual %>%\n  group_by(uc, ano, expedicao) %>%\n  summarize(esforco_total_expedicao = sum(esforco_individual, na.rm = TRUE)) %>%\n  ungroup()\n\n# Calcular o esforço total anual para cada ano\nesforco_total_anual <- esforco_por_expedicao %>%\n  group_by(ano) %>%\n  summarize(esforco_total_anual = sum(esforco_total_expedicao, na.rm = TRUE)) %>%\n  ungroup()\n\n# Juntar com soma_individuos_por_tribo_ano\ndf_agregado <- soma_individuos_por_tribo_ano %>%\n  left_join(esforco_total_anual, by = \"ano\") %>%\n  ungroup()\n\n# Calcular o índice de abundância\ndf_agregado <- df_agregado %>%\n  mutate(frequencia_corrigida = (soma_individuos + 0.00001) / esforco_total_anual,\n         log_frequencia_corrigida = log10(frequencia_corrigida)) %>%\n  group_by(tribo) %>%\n  arrange(ano) %>%\n  mutate(indice_abundancia = if_else(row_number() == 1, 1, \n                                     log_frequencia_corrigida / lag(log_frequencia_corrigida))) %>%\n  ungroup()\n\n# Reestruturar para visualização\ndf_tribo_ano_largo <- df_agregado %>%\n  pivot_wider(names_from = ano, values_from = indice_abundancia)\n\n# Reestruturar o dataframe para o formato largo # tabela geral dos índices\ndf_tribo_ano_largo <- df_agregado %>%\n  select(tribo, ano, indice_abundancia) %>% # Selecionar as colunas relevantes\n  pivot_wider(names_from = ano, values_from = indice_abundancia) # Transformar para o formato largo\n\n# Limitar os valores a 3 casas decimais\ndf_tribo_ano_largo <- df_tribo_ano_largo %>%\n  mutate_if(is.numeric, ~ round(., 3))\n#write.csv(df_tribo_ano_largo, \"tabela_índice_tribo_ano_MataAtlantica.csv\", row.names = FALSE)\n\n#knitr::include_graphics(\"imagens/cap04/bo_IA_mata_atlantica.JPG\")\n\n```\n\n\n```{r grafico IA-mata-atlantica-floresta}\n#| label: fig-IA-mata-atlantica-floresta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) no bioma Mata Atlântica, no período de 2014 a 2022.\"\n\n\n#Gráficos\nlibrary(ggplot2)\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Brassolini\" = \"#003C30\", \"Morphini\" = \"#23867E\")\ntipos_linhas <- c(\"Brassolini\" = \"solid\", \"Morphini\" = \"dashed\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>% #Nao teve captura de Haeterini\n  filter(tribo %in% c(\"Brassolini\", \"Morphini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Brassolini\", \"Morphini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Brassolini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Morphini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_florestal <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0.5, 3.0))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"Mata Atlântica\",\n       subtitle = \"Borboletas de áreas fechadas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico\nprint(gg_florestal)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia MataAtlantica_florestal_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_florestal,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n\n```{r grafico IA-mata-atlantica-area-aberta}\n#| label: fig-IA-mata-atlantica-area-aberta\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) no bioma Mata Atlântica, no período de 2014 a 2022.\"\n\n\n#Gráficos Borboletas de areas abertas\n\n# Definir as cores e tipos de linha para cada tribo\ncores_linhas <- c(\"Callicorini\" = \"#CFA154\", \"Biblidini\" = \"#824B09\", \"Ageroniini\" = \"#543005\")\ntipos_linhas <- c(\"Callicorini\" = \"twodash\", \"Biblidini\" = \"dashed\", \"Ageroniini\" = \"solid\")\n\n# Filtrar tribos florestais\ntribos_selecionadas <- df_tribo_ano_largo %>%\n  filter(tribo %in% c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")) %>%\n  mutate(tribo = factor(tribo, levels = c(\"Callicorini\", \"Biblidini\", \"Ageroniini\")))\n\n# Transformar 'ano' para o formato longo e garantir que é numérico\ndados_longos <- tribos_selecionadas %>%\n  pivot_longer(cols = -tribo, names_to = \"ano\", values_to = \"indice_abundancia\")\n\n# Certifique-se de que cada 'tribo' tem um 'tipo_linha' correspondente\ndados_longos$tipo_linha <- ifelse(dados_longos$tribo == \"Ageroniini\", \"solid\",\n                                  ifelse(dados_longos$tribo == \"Biblidini\",\"dashed\",\"twodash\"))\n\n# Crie o gráfico\ngg_aberto <- ggplot(dados_longos, aes(x = ano, y = indice_abundancia, group = tribo, color = tribo, linetype = tribo)) +\n  geom_line(size = 0.7) +\n  scale_y_continuous(limits = c(0.5, 3.0))+\n  scale_color_manual(values = cores_linhas) +\n  scale_linetype_manual(values = tipos_linhas) +\n  geom_hline(yintercept = 1.0, linetype = \"dashed\", color = \"darkgray\", size = 0.7) +\n  theme_minimal() +\n  labs(title = \"\",\n       subtitle = \"Borboletas de áreas abertas\",\n       x = \"\",\n       y = expression(\"Índice de Abundância (\" * italic(\"i\") * \")\"),\n       color = \"Tribo\",\n       linetype = \"Tribo\") +\n  theme(plot.title = element_text(hjust = 0.5, size = 14),\n        plot.subtitle = element_text(hjust = 0.5, size = 12),\n        axis.title = element_text(size = 10),\n        axis.text = element_text(size = 8),\n        legend.title = element_text(size = 10),\n        legend.text = element_text(size = 10),\n        axis.line = element_line(color = \"black\"),\n        axis.ticks.y = element_line(color = \"black\"),\n        panel.grid.minor = element_blank(),\n        axis.line.x = element_blank()) +\n  guides(color = guide_legend(override.aes = list(linetype = tipos_linhas)))\n\n# Exibir o gráfico #só tem 1 registro de callicorini, em 2018.\nprint(gg_aberto)\n\n# Salvar a imagem usando ggsave()\n# ggsave(filename = \"indice de abundancia MataAtlantica_aberto_linhas_.png\",  # Escolha um nome adequado para o arquivo\n#        plot = gg_aberto,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\",  # Especifique o diretório onde você deseja salvar o gráfico\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 12, height = 8, units = \"in\")  # Define o tamanho da imagem\n\n\n```\n\n\n```{r grafico IA-mata-atlantica-juntos}\n#| label: fig-IA-mata-atlantica-juntos\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n#| fig-cap: \"Variação no índice de abundância das tribos de borboletas frugívoras indicadoras de florestas íntegras (tons de verde) e de florestas perturbadas (tons de laranja) no bioma Cerrado, no período de 2014 a 2022.\"\n\n#Gráficos juntos\nlibrary(gridExtra)\n\ngrid.arrange(gg_florestal, gg_aberto, ncol = 1,  heights = c(3,3))\n# ggsave(\"graficos_combinados_indice_MataAtlantica_linhas.png\", \n#        grid.arrange(gg_florestal, gg_aberto, ncol = 1,  heights = c(3,3)), \n#        device = \"png\", \n#        width = 12, height = 10, units = \"in\", \n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n\n#knitr::include_graphics(\"imagens/cap04/bo_IA_cerrado.JPG\")\n\n```\n\n### Destaques\n\n</br>\n\n\n#### Efeito da queda dos tabocais nas RESEXs do Cazumbá-Iracema, do Alto Tarauacá, Riozinho da Liberdade e Chico Mendes e no PARNA da Serra do Divisor\n\n\n\n</br>\n\n\n```{r grafico abundancia-resex-cazumba-iracema}\n#| label: fig-abundancia-resex-cazumba-iracema\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '75%'\n\n\n# Análise  de efeito da queda do tabocal nas tribos de borboletas frugívoras - AUTOMATIZADO\n# RESEX do Cazumbá-Iracema\n# Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(car)\n\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\ndados_borboletas <- read.table(\"data/dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\ndados_borboletas$ano <- as.factor(dados_borboletas$ano)\ndados_borboletas <- dados_borboletas[dados_borboletas$ano != \"2023\", ]\ndados_borboletas <- dados_borboletas[!is.na(dados_borboletas$tribo), ]\n\n\ndados_regiao_especifica <- dados_borboletas %>%\n  filter(uc == 'Resex_do_Cazumba-Iracema')\n\n# Calcular o esforço amostral para cada combinação de uc_ea, expedicao e ano\nesforco_por_expedicao <- dados_regiao_especifica %>%\n  group_by(uc_ea, uc, expedicao, ano) %>%\n  summarize(\n    max_dia_amostragem = max(dia_amostragem) - 1,\n    .groups = 'drop'\n  ) %>%\n  mutate(\n    esforco_amostral = 16 * max_dia_amostragem\n  )\n\n# Agregar o esforço de amostragem para cada uc_ea e ano\nesforco_total_por_ea_ano <- esforco_por_expedicao %>%\n  group_by(uc_ea, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregar o esforço de amostragem para cada uc e ano\nesforco_total_por_uc_ano <- esforco_por_expedicao %>%\n  group_by(uc, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o esforço total por ano\nesforco_por_ano <- esforco_total_por_uc_ano %>%\n  group_by(ano,uc) %>%\n  summarize(\n    esforco = sum(esforco_total_ano),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o número total de indivíduos por ano\nnum_ind_por_ano <- dados_regiao_especifica %>%\n  group_by(ano) %>%\n  summarize(\n    num_ind = sum(individuos, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n#criando uma coluna de UA e selecionando somente as colunas interessadas pra analise\ndados_regiao_especifica <- dados_regiao_especifica %>%\n  mutate(ua = paste(uc_ea, transeccao, sep = \"_\"))\n\n#combinando os dados por UA por ano = 12 (3 ea x 4 parcelas)\ndf_abu_ano <- dados_regiao_especifica %>%\n  group_by(tribo, ua, uc_ea,uc, ano) %>%\n  summarise(abundancia = sum(individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Transforma o df para colocar os zeros\ndf_tabocal <- df_abu_ano %>%\n  spread(key = tribo, value = abundancia, fill = 0)\n\n# Retorna ao formato longo para as análises\ndf_long <- df_tabocal %>%\n  pivot_longer(cols = Ageroniini:Satyrini, names_to = \"tribo\", values_to = \"individuos\")\n\n# Agregação para obter a abundância total de cada tribo por ano\nabundancia_por_ano <- df_long %>%\n  group_by(tribo, ano) %>%\n  summarize(\n    abundancia_total = sum(individuos)\n  )\n\n# Juntar as tabelas pela coluna 'ano' e 'uc'\ndf_long_com_esforco <- left_join(df_long, esforco_por_ano, by = c(\"ano\", \"uc\"))\n\n\n# Calcular a abundância padronizada pelo esforço amostral\ndf_long <- df_long_com_esforco %>%\n  mutate(abundancia_padronizada = (individuos / esforco) * 100)\n#\n\nlibrary(tidyverse)\n\n# Realizar análise e gerar gráficos para cada tribo\n\ntribos <- unique(df_long$tribo)\n\nfor (tribo_atual in tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n}\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Adicione o ano de 2020, mesmo que não haja dados\n  medianas_anuais <- c(medianas_anuais, NA)\n  names(medianas_anuais)[length(medianas_anuais)] <- \"2020\"\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = as.character(unique(c(names(medianas_anuais), \"2020\"))), MedianaAnual = c(medianas_anuais, NA))\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- c(erros_padrao, NA)\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup)*1.1\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = .7) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"Ano\",\n         y = \"Mediana da Abundância / Esforço Amostral\") +\n    theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5.5),\n          axis.text = element_text(size = 6),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Exiba o gráfico ajustado\n  print(p_tribo)\n  \n  # Salvar a imagem usando ggsave()\n#   ggsave(filename = paste(\"mediana_\", gsub(\" \", \"_\", tolower(tribo_atual)), \"_ajustado_pontos_linha_2020.png\", sep = \"\"),  # Escolha um nome adequado para o arquivo\n#          plot = p_tribo,  # O objeto ggplot\n#          device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#          path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Cazumba-Iracema\",  # Especifique o diretório onde você deseja salvar o gráfico\n#          dpi = 300,  # Define a resolução (DPI)\n#          width = 6, height = 5, units = \"in\")  # Define o tamanho da imagem\n# }\n\n\nlibrary(gridExtra)\n\n# Definir uma lista para armazenar os gráficos\nlista_graficos <- list()\n\n# Defina a ordem das tribos\nordem_tribos <- c(\"Brassolini\", \"Morphini\", \"Haeterini\", \"Preponini\", \"Melanitini\", \"Anaeini\", \n                  \"Epicaliini\", \"Epiphilini\", \"Coeini\", \"Satyrini\", \"Callicorini\", \"Biblidini\", \"Ageroniini\")\n\nfor (tribo_atual in ordem_tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Adicione o ano de 2020, mesmo que não haja dados\n  medianas_anuais <- c(medianas_anuais, NA)\n  names(medianas_anuais)[length(medianas_anuais)] <- \"2020\"\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = as.character(unique(c(names(medianas_anuais), \"2020\"))), MedianaAnual = c(medianas_anuais, NA))\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- c(erros_padrao, NA)\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup) * 1.1\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"\",\n         y = \"Mediana da Abundância \n / Esforço Amostral\") +\n    theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5.5),\n          axis.text = element_text(size = 6),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Adicionar o gráfico atual à lista\n  lista_graficos[[tribo_atual]] <- p_tribo\n}\n\n\n\n```\n\n\n```{r grafico abundancia-resex-cazumba-iracema-combinada}\n#| label: fig-abundancia-resex-cazumba-iracema-combinada\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '90%'\n#| fig-cap: \"Variação na abundância das tribos de borboletas frugívoras na RESEX do Cazumbá-Iracema no período de 2020 a 2022.\"\n\n# Combine todos os gráficos em uma única imagem\nimagem_combinada <- grid.arrange(grobs = lista_graficos, ncol = 3)\n\n# Salvar a imagem combinada usando ggsave()\n# ggsave(filename = \"todos_graficos_cazumba_iracema.png\",  # Escolha um nome adequado para o arquivo\n#        plot = imagem_combinada,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Cazumba-Iracema\",  # Especifique o diretório onde você deseja salvar a imagem\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 14, height = 12, units = \"in\")  # Define o tamanho da imagem\n\n\n\n```\n\n\n</br>\n\n\n\n```{r grafico abundancia-resex-alto-tarauaca}\n#| label: fig-abundancia-resex-alto-tarauaca\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n\n\n\n# Análise  de efeito da queda do tabocal nas tribos de borboletas frugívoras - AUTOMATIZADO\n# RESEX do Alto Taraucá\n# Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(car)\n\n#setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n\n# dados_borboletas <- read.table(\"dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\n# dados_borboletas$ano <- as.factor(dados_borboletas$ano)\n# dados_borboletas <- dados_borboletas[dados_borboletas$ano != \"2023\", ]\n# dados_borboletas <- dados_borboletas[!is.na(dados_borboletas$tribo), ]\n\n\ndados_regiao_especifica <- dados_borboletas %>%\n  filter(uc == 'Resex_do_Alto_Tarauaca')\n\n# Calcular o esforço amostral para cada combinação de uc_ea, expedicao e ano\nesforco_por_expedicao <- dados_regiao_especifica %>%\n  group_by(uc_ea, uc, expedicao, ano) %>%\n  summarize(\n    max_dia_amostragem = max(dia_amostragem) - 1,\n    .groups = 'drop'\n  ) %>%\n  mutate(\n    esforco_amostral = 16 * max_dia_amostragem\n  )\n\n# Agregar o esforço de amostragem para cada uc_ea e ano\nesforco_total_por_ea_ano <- esforco_por_expedicao %>%\n  group_by(uc_ea, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregar o esforço de amostragem para cada uc e ano\nesforco_total_por_uc_ano <- esforco_por_expedicao %>%\n  group_by(uc, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o esforço total por ano\nesforco_por_ano <- esforco_total_por_uc_ano %>%\n  group_by(ano,uc) %>%\n  summarize(\n    esforco = sum(esforco_total_ano),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o número total de indivíduos por ano\nnum_ind_por_ano <- dados_regiao_especifica %>%\n  group_by(ano) %>%\n  summarize(\n    num_ind = sum(individuos, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n#criando uma coluna de UA e selecionando somente as colunas interessadas pra analise\ndados_regiao_especifica <- dados_regiao_especifica %>%\n  mutate(ua = paste(uc_ea, transeccao, sep = \"_\"))\n\n#combinando os dados por UA por ano = 12 (3 ea x 4 parcelas)\ndf_abu_ano <- dados_regiao_especifica %>%\n  group_by(tribo, ua, uc_ea,uc, ano) %>%\n  summarise(abundancia = sum(individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Transforma o df para colocar os zeros\ndf_tabocal <- df_abu_ano %>%\n  spread(key = tribo, value = abundancia, fill = 0)\n\n# Retorna ao formato longo para as análises\ndf_long <- df_tabocal %>%\n  pivot_longer(cols = Ageroniini:Satyrini, names_to = \"tribo\", values_to = \"individuos\")\n\n# Agregação para obter a abundância total de cada tribo por ano\nabundancia_por_ano <- df_long %>%\n  group_by(tribo, ano) %>%\n  summarize(\n    abundancia_total = sum(individuos)\n  )\n\n# Juntar as tabelas pela coluna 'ano' e 'uc'\ndf_long_com_esforco <- left_join(df_long, esforco_por_ano, by = c(\"ano\", \"uc\"))\n\n\n# Calcular a abundância padronizada pelo esforço amostral\ndf_long <- df_long_com_esforco %>%\n  mutate(abundancia_padronizada = (individuos / esforco) * 100)\n#\n\nlibrary(tidyverse)\n\n# Realizar análise e gerar gráficos para cada tribo\n\ntribos <- unique(df_long$tribo)\n\nfor (tribo_atual in tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Adicione o ano de 2020, mesmo que não haja dados\n  medianas_anuais <- c(medianas_anuais, NA)\n  names(medianas_anuais)[length(medianas_anuais)] <- \"2020\"\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = as.character(unique(c(names(medianas_anuais), \"2020\"))), MedianaAnual = c(medianas_anuais, NA))\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- c(erros_padrao, NA)\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup)*1.2\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"Ano\",\n         y = \"Mediana da Abundância / Esforço Amostral\") +\n    theme_minimal() +\n    theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5),\n          axis.text = element_text(size = 5),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Exiba o gráfico ajustado\n  print(p_tribo)\n  \n  # Salvar a imagem usando ggsave()\n  ggsave(filename = paste(\"mediana_\", gsub(\" \", \"_\", tolower(tribo_atual)), \"_ajustado_pontos_linha_2020.png\", sep = \"\"),  # Escolha um nome adequado para o arquivo\n         plot = p_tribo,  # O objeto ggplot\n         device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n         path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Alto Tarauaca\",  # Especifique o diretório onde você deseja salvar o gráfico\n         dpi = 300,  # Define a resolução (DPI)\n         width = 6, height = 5, units = \"in\")  # Define o tamanho da imagem\n}\n\n\nlibrary(gridExtra)\n\n# Definir uma lista para armazenar os gráficos\nlista_graficos <- list()\n\n# Defina a ordem das tribos\nordem_tribos <- c(\"Brassolini\", \"Morphini\", \"Haeterini\", \"Preponini\", \"Melanitini\", \"Anaeini\", \n                  \"Epicaliini\", \"Epiphilini\", \"Coeini\", \"Satyrini\", \"Callicorini\", \"Biblidini\", \"Ageroniini\")\n\nfor (tribo_atual in ordem_tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Adicione o ano de 2020, mesmo que não haja dados\n  medianas_anuais <- c(medianas_anuais, NA)\n  names(medianas_anuais)[length(medianas_anuais)] <- \"2020\"\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = as.character(unique(c(names(medianas_anuais), \"2020\"))), MedianaAnual = c(medianas_anuais, NA))\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- c(erros_padrao, NA)\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup) * 1.2\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"\",\n         y = \"Mediana da Abundância \n / Esforço Amostral\") +\n    theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5),\n          axis.text = element_text(size = 5),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Adicionar o gráfico atual à lista\n  lista_graficos[[tribo_atual]] <- p_tribo\n}\n\n\n```\n\n</br>\n\n\n```{r grafico abundancia-resex-alto-tarauca-combinada}\n#| label: fig-abundancia-resex-alto-tarauaca-combinada\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '75%'\n#| fig-cap: \"Variação na abundância das tribos de borboletas frugívoras na RESEX do Alto Tarauacá no período de 2020 a 2022.\"\n\n# Combine todos os gráficos em uma única imagem\nimagem_combinada <- grid.arrange(grobs = lista_graficos, ncol = 3)\n\n# Salvar a imagem combinada usando ggsave()\n# ggsave(filename = \"todos_graficos_alto_tarauaca.png\",  # Escolha um nome adequado para o arquivo\n#        plot = imagem_combinada,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Alto Tarauaca\",  # Especifique o diretório onde você deseja salvar a imagem\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 14, height = 12, units = \"in\")  # Define o tamanho da imagem\n\n\n```\n\n</br>\n\n\n```{r grafico abundancia-resex-riozinho-da-liberdade}\n#| label: fig-abundancia-resex-riozinho-da-liberdade\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n\n\n\n# Análise  de efeito da queda do tabocal nas tribos de borboletas frugívoras - AUTOMATIZADO\n# RESEX Riozinho da Liberdade\n# Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(car)\n\n# setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n# \n# dados_borboletas <- read.table(\"dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\n# dados_borboletas$ano <- as.factor(dados_borboletas$ano)\n# dados_borboletas <- dados_borboletas[dados_borboletas$ano != \"2023\", ]\n# dados_borboletas <- dados_borboletas[!is.na(dados_borboletas$tribo), ]\n\n\ndados_regiao_especifica <- dados_borboletas %>%\n  filter(uc == 'Resex_Riozinho_da_Liberdade')\n\n# Calcular o esforço amostral para cada combinação de uc_ea, expedicao e ano\nesforco_por_expedicao <- dados_regiao_especifica %>%\n  group_by(uc_ea, uc, expedicao, ano) %>%\n  summarize(\n    max_dia_amostragem = max(dia_amostragem) - 1,\n    .groups = 'drop'\n  ) %>%\n  mutate(\n    esforco_amostral = 16 * max_dia_amostragem\n  )\n\n# Agregar o esforço de amostragem para cada uc_ea e ano\nesforco_total_por_ea_ano <- esforco_por_expedicao %>%\n  group_by(uc_ea, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregar o esforço de amostragem para cada uc e ano\nesforco_total_por_uc_ano <- esforco_por_expedicao %>%\n  group_by(uc, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o esforço total por ano\nesforco_por_ano <- esforco_total_por_uc_ano %>%\n  group_by(ano,uc) %>%\n  summarize(\n    esforco = sum(esforco_total_ano),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o número total de indivíduos por ano\nnum_ind_por_ano <- dados_regiao_especifica %>%\n  group_by(ano) %>%\n  summarize(\n    num_ind = sum(individuos, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n#criando uma coluna de UA e selecionando somente as colunas interessadas pra analise\ndados_regiao_especifica <- dados_regiao_especifica %>%\n  mutate(ua = paste(uc_ea, transeccao, sep = \"_\"))\n\n#combinando os dados por UA por ano = 12 (3 ea x 4 parcelas)\ndf_abu_ano <- dados_regiao_especifica %>%\n  group_by(tribo, ua, uc_ea,uc, ano) %>%\n  summarise(abundancia = sum(individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Transforma o df para colocar os zeros\ndf_tabocal <- df_abu_ano %>%\n  spread(key = tribo, value = abundancia, fill = 0)\n\n# Retorna ao formato longo para as análises\ndf_long <- df_tabocal %>%\n  pivot_longer(cols = Ageroniini:Satyrini, names_to = \"tribo\", values_to = \"individuos\")\n\n# Agregação para obter a abundância total de cada tribo por ano\nabundancia_por_ano <- df_long %>%\n  group_by(tribo, ano) %>%\n  summarize(\n    abundancia_total = sum(individuos)\n  )\n\n# Juntar as tabelas pela coluna 'ano' e 'uc'\ndf_long_com_esforco <- left_join(df_long, esforco_por_ano, by = c(\"ano\", \"uc\"))\n\n\n# Calcular a abundância padronizada pelo esforço amostral\ndf_long <- df_long_com_esforco %>%\n  mutate(abundancia_padronizada = (individuos / esforco) * 100)\n#\n\nlibrary(tidyverse)\n\n# Realizar análise e gerar gráficos para cada tribo\n\ntribos <- unique(df_long$tribo)\n\nfor (tribo_atual in tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = names(medianas_anuais), MedianaAnual = medianas_anuais)\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- erros_padrao\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup)*1.1\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"Ano\",\n         y = \"Mediana da Abundância / Esforço Amostral\") +\n    theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5),\n          axis.text = element_text(size = 5),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Exiba o gráfico ajustado\n  print(p_tribo)\n  \n  # Salvar a imagem usando ggsave()\n  ggsave(filename = paste(\"mediana_\", gsub(\" \", \"_\", tolower(tribo_atual)), \"_ajustado_pontos_linha_2020.png\", sep = \"\"),  # Escolha um nome adequado para o arquivo\n         plot = p_tribo,  # O objeto ggplot\n         device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n         path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Riozinho da Liberdade\",  # Especifique o diretório onde você deseja salvar o gráfico\n         dpi = 300,  # Define a resolução (DPI)\n         width = 6, height = 5, units = \"in\")  # Define o tamanho da imagem\n}\n\n\nlibrary(gridExtra)\n\n# Definir uma lista para armazenar os gráficos\nlista_graficos <- list()\n\n# Defina a ordem das tribos\nordem_tribos <- c(\"Brassolini\", \"Morphini\", \"Haeterini\", \"Preponini\", \"Melanitini\", \"Anaeini\", \n                  \"Epicaliini\", \"Epiphilini\", \"Coeini\", \"Satyrini\", \"Callicorini\", \"Biblidini\", \"Ageroniini\")\n\nfor (tribo_atual in ordem_tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = names(medianas_anuais), MedianaAnual = medianas_anuais)\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- erros_padrao\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup) * 1.1\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"\",\n         y = \"Mediana da Abundância \n / Esforço Amostral\") +\n    theme_minimal() +\n    theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5),\n          axis.text = element_text(size = 5),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Adicionar o gráfico atual à lista\n  lista_graficos[[tribo_atual]] <- p_tribo\n}\n\n\n```\n\n</br>\n\n\n```{r grafico abundancia-resex-riozinho-da-liberdade-combinada}\n#| label: fig-abundancia-resex-riozinho-da-liberdade-combinada\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '75%'\n#| fig-cap: \"Variação na abundância das tribos de borboletas frugívoras na RESEX do Riozinho da Liberdade no período de 2020 a 2022.\"\n\n# Combine todos os gráficos em uma única imagem\nimagem_combinada <- grid.arrange(grobs = lista_graficos, ncol = 3)\n\n# Salvar a imagem combinada usando ggsave()\n# ggsave(filename = \"todos_graficos_riozinho_da_liberdade.png\",  # Escolha um nome adequado para o arquivo\n#        plot = imagem_combinada,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Riozinho da Liberdade\",  # Especifique o diretório onde você deseja salvar a imagem\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 14, height = 12, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n</br>\n\n\n```{r grafico abundancia-resex-chico-mendes}\n#| label: fig-abundancia-resex-chico-mendes\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n\n\n\n# Análise  de efeito da queda do tabocal nas tribos de borboletas frugívoras - AUTOMATIZADO\n# RESEX Chico Mendes\n# Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(car)\n\n# setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n# \n# dados_borboletas <- read.table(\"dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\n# dados_borboletas$ano <- as.factor(dados_borboletas$ano)\n# dados_borboletas <- dados_borboletas[dados_borboletas$ano != \"2023\", ]\n# dados_borboletas <- dados_borboletas[!is.na(dados_borboletas$tribo), ]\n\n\ndados_regiao_especifica <- dados_borboletas %>%\n  filter(uc == 'Resex_Chico_Mendes')\n\n# Calcular o esforço amostral para cada combinação de uc_ea, expedicao e ano\nesforco_por_expedicao <- dados_regiao_especifica %>%\n  group_by(uc_ea, uc, expedicao, ano) %>%\n  summarize(\n    max_dia_amostragem = max(dia_amostragem) - 1,\n    .groups = 'drop'\n  ) %>%\n  mutate(\n    esforco_amostral = 16 * max_dia_amostragem\n  )\n\n# Agregar o esforço de amostragem para cada uc_ea e ano\nesforco_total_por_ea_ano <- esforco_por_expedicao %>%\n  group_by(uc_ea, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregar o esforço de amostragem para cada uc e ano\nesforco_total_por_uc_ano <- esforco_por_expedicao %>%\n  group_by(uc, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o esforço total por ano\nesforco_por_ano <- esforco_total_por_uc_ano %>%\n  group_by(ano,uc) %>%\n  summarize(\n    esforco = sum(esforco_total_ano),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o número total de indivíduos por ano\nnum_ind_por_ano <- dados_regiao_especifica %>%\n  group_by(ano) %>%\n  summarize(\n    num_ind = sum(individuos, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n#criando uma coluna de UA e selecionando somente as colunas interessadas pra analise\ndados_regiao_especifica <- dados_regiao_especifica %>%\n  mutate(ua = paste(uc_ea, transeccao, sep = \"_\"))\n\n#combinando os dados por UA por ano = 12 (3 ea x 4 parcelas)\ndf_abu_ano <- dados_regiao_especifica %>%\n  group_by(tribo, ua, uc_ea,uc, ano) %>%\n  summarise(abundancia = sum(individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Transforma o df para colocar os zeros\ndf_tabocal <- df_abu_ano %>%\n  spread(key = tribo, value = abundancia, fill = 0)\n\n# Retorna ao formato longo para as análises\ndf_long <- df_tabocal %>%\n  pivot_longer(cols = Ageroniini:Satyrini, names_to = \"tribo\", values_to = \"individuos\")\n\n# Agregação para obter a abundância total de cada tribo por ano\nabundancia_por_ano <- df_long %>%\n  group_by(tribo, ano) %>%\n  summarize(\n    abundancia_total = sum(individuos)\n  )\n\n# Juntar as tabelas pela coluna 'ano' e 'uc'\ndf_long_com_esforco <- left_join(df_long, esforco_por_ano, by = c(\"ano\", \"uc\"))\n\n\n# Calcular a abundância padronizada pelo esforço amostral\ndf_long <- df_long_com_esforco %>%\n  mutate(abundancia_padronizada = (individuos / esforco) * 100)\n#\n\nlibrary(tidyverse)\n\n# Realizar análise e gerar gráficos para cada tribo\n\ntribos <- unique(df_long$tribo)\n\nfor (tribo_atual in tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = names(medianas_anuais), MedianaAnual = medianas_anuais)\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- erros_padrao\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup)*1.1\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"Ano\",\n         y = \"Mediana da Abundância / Esforço Amostral\") +\n    theme_minimal() +\n     theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5),\n          axis.text = element_text(size = 5),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Exiba o gráfico ajustado\n  print(p_tribo)\n  \n  # Salvar a imagem usando ggsave()\n  ggsave(filename = paste(\"mediana_\", gsub(\" \", \"_\", tolower(tribo_atual)), \"_ajustado_pontos_linha_2020.png\", sep = \"\"),  # Escolha um nome adequado para o arquivo\n         plot = p_tribo,  # O objeto ggplot\n         device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n         path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Chico Mendes\",  # Especifique o diretório onde você deseja salvar o gráfico\n         dpi = 300,  # Define a resolução (DPI)\n         width = 6, height = 5, units = \"in\")  # Define o tamanho da imagem\n}\n\n\nlibrary(gridExtra)\n\n# Definir uma lista para armazenar os gráficos\nlista_graficos <- list()\n\n# Defina a ordem das tribos\nordem_tribos <- c(\"Brassolini\", \"Morphini\", \"Haeterini\", \"Preponini\", \"Melanitini\", \"Anaeini\", \n                  \"Epicaliini\", \"Epiphilini\", \"Coeini\", \"Satyrini\", \"Callicorini\", \"Biblidini\", \"Ageroniini\")\n\nfor (tribo_atual in ordem_tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = names(medianas_anuais), MedianaAnual = medianas_anuais)\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- erros_padrao\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup) * 1.1\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"\",\n         y = \"Mediana da Abundância \n / Esforço Amostral\") +\n    theme_minimal() +\n     theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5),\n          axis.text = element_text(size = 5),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Adicionar o gráfico atual à lista\n  lista_graficos[[tribo_atual]] <- p_tribo\n}\n\n\n```\n\n</br>\n\n\n```{r grafico abundancia-resex-chico-mendes-combinada}\n#| label: fig-abundancia-resex-chico-mendes-combinada\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '75%'\n#| fig-cap: \"Variação na abundância das tribos de borboletas frugívoras na RESEX Chico Mendes no período de 2020 a 2022.\"\n\n# Combine todos os gráficos em uma única imagem\nimagem_combinada <- grid.arrange(grobs = lista_graficos, ncol = 3)\n\n# Salvar a imagem combinada usando ggsave()\n# ggsave(filename = \"todos_graficos_chico_mendes.png\",  # Escolha um nome adequado para o arquivo\n#        plot = imagem_combinada,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Chico Mendes\",  # Especifique o diretório onde você deseja salvar a imagem\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 14, height = 12, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n</br>\n\n```{r grafico abundancia-parna-serra-divisor}\n#| label: fig-abundancia-parna-serra-divisor\n#| echo: false\n#| include: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '70%'\n\n\n\n# Análise  de efeito da queda do tabocal nas tribos de borboletas frugívoras - AUTOMATIZADO\n# PARANA Serra do Divisor\n# Script: Isabela Freitas Oliveira\n\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(car)\n\n# setwd(\"~/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela\")\n# \n# dados_borboletas <- read.table(\"dados_analise_borboletas_Isabela_V2.txt\", header = TRUE)\n# dados_borboletas$ano <- as.factor(dados_borboletas$ano)\n# dados_borboletas <- dados_borboletas[dados_borboletas$ano != \"2023\", ]\n# dados_borboletas <- dados_borboletas[!is.na(dados_borboletas$tribo), ]\n\n\ndados_regiao_especifica <- dados_borboletas %>%\n  filter(uc == 'Parna_da_Serra_do_Divisor')\n\n# Calcular o esforço amostral para cada combinação de uc_ea, expedicao e ano\nesforco_por_expedicao <- dados_regiao_especifica %>%\n  group_by(uc_ea, uc, expedicao, ano) %>%\n  summarize(\n    max_dia_amostragem = max(dia_amostragem) - 1,\n    .groups = 'drop'\n  ) %>%\n  mutate(\n    esforco_amostral = 16 * max_dia_amostragem\n  )\n\n# Agregar o esforço de amostragem para cada uc_ea e ano\nesforco_total_por_ea_ano <- esforco_por_expedicao %>%\n  group_by(uc_ea, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregar o esforço de amostragem para cada uc e ano\nesforco_total_por_uc_ano <- esforco_por_expedicao %>%\n  group_by(uc, ano) %>%\n  summarize(\n    esforco_total_ano = sum(esforco_amostral),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o esforço total por ano\nesforco_por_ano <- esforco_total_por_uc_ano %>%\n  group_by(ano,uc) %>%\n  summarize(\n    esforco = sum(esforco_total_ano),\n    .groups = 'drop'\n  )\n\n# Agregação para obter o número total de indivíduos por ano\nnum_ind_por_ano <- dados_regiao_especifica %>%\n  group_by(ano) %>%\n  summarize(\n    num_ind = sum(individuos, na.rm = TRUE),\n    .groups = 'drop'\n  )\n\n#criando uma coluna de UA e selecionando somente as colunas interessadas pra analise\ndados_regiao_especifica <- dados_regiao_especifica %>%\n  mutate(ua = paste(uc_ea, transeccao, sep = \"_\"))\n\n#combinando os dados por UA por ano = 12 (3 ea x 4 parcelas)\ndf_abu_ano <- dados_regiao_especifica %>%\n  group_by(tribo, ua, uc_ea,uc, ano) %>%\n  summarise(abundancia = sum(individuos, na.rm = TRUE)) %>%\n  ungroup()\n\n# Transforma o df para colocar os zeros\ndf_tabocal <- df_abu_ano %>%\n  spread(key = tribo, value = abundancia, fill = 0)\n\n# Retorna ao formato longo para as análises\ndf_long <- df_tabocal %>%\n  pivot_longer(cols = Ageroniini:Satyrini, names_to = \"tribo\", values_to = \"individuos\")\n\n# Agregação para obter a abundância total de cada tribo por ano\nabundancia_por_ano <- df_long %>%\n  group_by(tribo, ano) %>%\n  summarize(\n    abundancia_total = sum(individuos)\n  )\n\n# Juntar as tabelas pela coluna 'ano' e 'uc'\ndf_long_com_esforco <- left_join(df_long, esforco_por_ano, by = c(\"ano\", \"uc\"))\n\n\n# Calcular a abundância padronizada pelo esforço amostral\ndf_long <- df_long_com_esforco %>%\n  mutate(abundancia_padronizada = (individuos / esforco) * 100)\n#\n\nlibrary(tidyverse)\n\n# Realizar análise e gerar gráficos para cada tribo\n\ntribos <- unique(df_long$tribo)\n\nfor (tribo_atual in tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Adicione o ano de 2020, mesmo que não haja dados\n  medianas_anuais <- c(medianas_anuais, NA)\n  names(medianas_anuais)[length(medianas_anuais)] <- \"2020\"\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = as.character(unique(c(names(medianas_anuais), \"2020\"))), MedianaAnual = c(medianas_anuais, NA))\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- c(erros_padrao, NA)\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup)*1.2\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"Ano\",\n         y = \"Mediana da Abundância / Esforço Amostral\") +\n    theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5),\n          axis.text = element_text(size = 5),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Exiba o gráfico ajustado\n  print(p_tribo)\n  \n  # Salvar a imagem usando ggsave()\n  ggsave(filename = paste(\"mediana_\", gsub(\" \", \"_\", tolower(tribo_atual)), \"_ajustado_pontos_linha_2020.png\", sep = \"\"),  # Escolha um nome adequado para o arquivo\n         plot = p_tribo,  # O objeto ggplot\n         device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n         path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Serra do Divisor\",  # Especifique o diretório onde você deseja salvar o gráfico\n         dpi = 300,  # Define a resolução (DPI)\n         width = 6, height = 5, units = \"in\")  # Define o tamanho da imagem\n}\n\n\nlibrary(gridExtra)\n\n# Definir uma lista para armazenar os gráficos\nlista_graficos <- list()\n\n# Defina a ordem das tribos\nordem_tribos <- c(\"Brassolini\", \"Morphini\", \"Haeterini\", \"Preponini\", \"Melanitini\", \"Anaeini\", \n                  \"Epicaliini\", \"Epiphilini\", \"Coeini\", \"Satyrini\", \"Callicorini\", \"Biblidini\", \"Ageroniini\")\n\nfor (tribo_atual in ordem_tribos) {\n  cat(\"Realizando análise e gerando gráfico para a tribo:\", tribo_atual, \"\\n\")\n  \n  # Filtrar os dados para a tribo atual\n  df_tribo <- df_long %>%\n    filter(tribo == tribo_atual)\n  \n  # Verificar se há dados para a tribo atual\n  if (nrow(df_tribo) == 0) {\n    cat(\"Não há dados para a tribo:\", tribo_atual, \"\\n\")\n    cat(\"Nenhuma análise ou gráfico gerado para a tribo:\", tribo_atual, \"\\n\")\n    next\n  }\n  \n  # Calcular a mediana anual para cada ano\n  medianas_anuais <- tapply(df_tribo$abundancia_padronizada, df_tribo$ano, median)\n  \n  # Adicione o ano de 2020, mesmo que não haja dados\n  medianas_anuais <- c(medianas_anuais, NA)\n  names(medianas_anuais)[length(medianas_anuais)] <- \"2020\"\n  \n  # Calcular a mediana geral das medianas anuais\n  mediana_geral_anual <- median(medianas_anuais, na.rm = TRUE)\n  \n  # Remover os anos com NA das medianas anuais\n  medianas_anuais <- medianas_anuais[!is.na(medianas_anuais)]\n  \n  # Crie um vetor para armazenar os resultados dos testes\n  resultados_teste_anual <- numeric(length(medianas_anuais))\n  \n  # Faça um loop pelos anos e realize o teste de Wilcoxon para cada ano\n  for (ano_atual in names(medianas_anuais)) {\n    # Realiza o teste de Wilcoxon comparando as medianas do ano atual com a mediana geral\n    wilcox_test_resultado <- wilcox.test(df_tribo$abundancia_padronizada[df_tribo$ano == ano_atual], mu = mediana_geral_anual, exact = FALSE)\n    \n    # Armazena o valor p do teste no vetor de resultados\n    resultados_teste_anual[ano_atual] <- wilcox_test_resultado$p.value\n  }\n  \n  # Crie um data frame com as medianas anuais, a mediana geral anual e os valores-p\n  df_plot <- data.frame(Ano = as.character(unique(c(names(medianas_anuais), \"2020\"))), MedianaAnual = c(medianas_anuais, NA))\n  df_plot$MedianaGeral <- mediana_geral_anual\n  df_plot$ValorP <- resultados_teste_anual[match(df_plot$Ano, names(resultados_teste_anual))]\n  \n  # Calcule os erros padrão para cada ano\n  erros_padrao <- sapply(names(medianas_anuais), function(ano) {\n    dados_ano <- df_tribo$abundancia_padronizada[df_tribo$ano == ano]\n    desvio_padrao_ano <- sd(dados_ano, na.rm = TRUE)\n    erro_padrao_ano <- desvio_padrao_ano / sqrt(length(dados_ano))\n    return(erro_padrao_ano)\n  })\n  \n  # Adicione os intervalos de confiança ao data frame\n  df_plot$ErroPadrao <- c(erros_padrao, NA)\n  df_plot$IntervaloConfiancaInf <- pmax(df_plot$MedianaAnual - 1.96 * df_plot$ErroPadrao, 0)\n  df_plot$IntervaloConfiancaSup <- df_plot$MedianaAnual + 1.96 * df_plot$ErroPadrao\n  \n  # Definir os limites do eixo y de acordo com os valores das medianas\n  y_limit <- max(df_plot$IntervaloConfiancaSup) * 1.2\n  \n  # Definir a cor de acordo com a tribo\n  cor_tribo <- if (tribo_atual %in% c(\"Brassolini\", \"Haeterini\", \"Morphini\")) {\n    \"#35978f\"\n  } else if (tribo_atual %in% c(\"Satyrini\", \"Coeini\", \"Epiphilini\", \"Epicaliini\", \"Anaeini\", \"Melanitini\", \"Preponini\")) {\n    \"gray40\"\n  } else {\n    \"#bf812d\"\n  }\n  \n  # Crie o gráfico ajustado com pontos e linhas\n  p_tribo <- ggplot(df_plot, aes(x = Ano, y = MedianaAnual)) +\n    geom_point(color = cor_tribo, size = 1) +\n    geom_line(size = 0.5, group = 1, color = cor_tribo) +  # Use group = 1 para conectar todos os pontos\n    geom_errorbar(aes(ymin = IntervaloConfiancaInf, ymax = IntervaloConfiancaSup), width = 0.2, color = cor_tribo) +\n    geom_hline(yintercept = mediana_geral_anual, linetype = \"dashed\", color = \"red\") +\n    labs(title = paste(\"\", tribo_atual),\n         x = \"\",\n         y = \"Mediana da Abundância \n / Esforço Amostral\") +\n    theme_minimal() +\n    theme(plot.title = element_text(hjust = 0.5, size = 8),\n          axis.title = element_text(size = 5),\n          axis.text = element_text(size = 5),\n          axis.line = element_line(color = \"black\"),\n          axis.ticks.y = element_line(color = \"black\"),\n          panel.grid.minor = element_blank(),\n          axis.line.x = element_blank(),\n          legend.position = \"none\") +  # Remover a legenda\n    ylim(0, y_limit) +  # Ajuste os limites conforme necessário\n    geom_text(data = df_plot[df_plot$ValorP < 0.05, ], \n              aes(x = Ano, y = IntervaloConfiancaSup, label = \"*\"), \n              vjust = -0.5,  \n              size = 3)\n  \n  # Adicionar o gráfico atual à lista\n  lista_graficos[[tribo_atual]] <- p_tribo\n}\n\n\n```\n\n</br>\n\n\n```{r grafico abundancia-parna-serra-divisor-combinada}\n#| label: fig-abundancia-parana-serra-divisor-combinada\n#| echo: false\n#| message: false\n#| warning: false\n#| cache: true\n#| fig.pos: 'H'\n#| out.width: '75%'\n#| fig-cap: \"Variação na abundância das tribos de borboletas frugívoras no PARNA Serra do Divisor no período de 2020 a 2022.\"\n\n# Combine todos os gráficos em uma única imagem\nimagem_combinada <- grid.arrange(grobs = lista_graficos, ncol = 3)\n\n# Salvar a imagem combinada usando ggsave()\n# ggsave(filename = \"todos_graficos_serra_do_divisor.png\",  # Escolha um nome adequado para o arquivo\n#        plot = imagem_combinada,  # O objeto ggplot\n#        device = \"png\",  # Pode ser \"jpeg\", \"tiff\", etc.\n#        path = \"/Users/isabelafreitasoliveira/Documents/ICMBIO-COMOB/Dados_Monitora/Análise de dados/Monitora_Borboletas_Isabela/Destaque/Serra do Divisor\",  # Especifique o diretório onde você deseja salvar a imagem\n#        dpi = 300,  # Define a resolução (DPI)\n#        width = 14, height = 12, units = \"in\")  # Define o tamanho da imagem\n\n```\n\n\n\n## Discussão\n\n\n</br>\n\n\n\n\n## Recomendações\n\n</br>\n\n::: callout-tip\n\n## Boas práticas para aprimorar o Programa\n\n</br>\n\n- Ampliar o número de unidades de conservação com aplicação do protocolo de borboletas frugívoras (Básico e Avançado) nos biomas Mata Atlântica e Cerrado; \n\n- Consolidar a implantação do protocolo de borboletas frugívoras naquelas unidades de conservação ainda não consolidadas, de forma que as UCs contem com pelo menos três estações amostrais implantadas e em operação; \n\n- Assegurar que durante as campanhas de campo as amostragens sejam realizadas de acordo com as diretrizes estabelecidas no protocolo amostral, em especial quanto ao respeito aos períodos de coleta definidos para cada região e em relação ao esforço amostral (número de dias de amostragens em cada EA); \n\n- Assegurar que os dados coletados sejam repassados à COMOB de acordo com as orientações definidas pela Coordenação e num prazo razoável após a realização da campanha de campo. \n\n::: ","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"freese":"auto","engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"cap04.html"},"language":{"toc-title-document":"Índice","toc-title-website":"Nesta página","related-formats-title":"Outros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fonte","other-links-title":"Outros Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Caderno de Artigo","notebook-preview-download":"Baixar Caderno","notebook-preview-download-src":"Baixar código-fonte","notebook-preview-back":"Voltar ao Artigo","manuscript-meca-bundle":"Arquivo MECA","section-title-abstract":"Resumo","section-title-appendices":"Apêndices","section-title-footnotes":"Notas de rodapé","section-title-references":"Referências","section-title-reuse":"Reuso","section-title-copyright":"Direito autoral","section-title-citation":"Citação","appendix-attribution-cite-as":"Por favor, cite este trabalho como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor","title-block-author-plural":"Autores","title-block-affiliation-single":"Afiliação","title-block-affiliation-plural":"Afiliações","title-block-published":"Data de Publicação","title-block-modified":"Modified","title-block-keywords":"Palavras-chave","callout-tip-title":"Dica","callout-note-title":"Nota","callout-warning-title":"Aviso","callout-important-title":"Importante","callout-caution-title":"Cuidado","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar o código","code-tools-hide-all-code":"Esconder o código","code-tools-view-source":"Ver o código fonte","code-tools-source-code":"Código fonte","tools-share":"Share","tools-download":"Download","code-line":"Linha","code-lines":"Linhas","copy-button-tooltip":"Copiar para a área de transferência","copy-button-tooltip-success":"Copiada","repo-action-links-edit":"Editar essa página","repo-action-links-source":"Ver o código fonte","repo-action-links-issue":"Criar uma issue","back-to-top":"De volta ao topo","search-no-results-text":"Nenhum resultado","search-matching-documents-text":"documentos correspondentes","search-copy-link-title":"Copiar link para a busca","search-hide-matches-text":"Esconder correspondências adicionais","search-more-match-text":"mais correspondência neste documento","search-more-matches-text":"mais correspondências neste documento","search-clear-button-title":"Limpar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Procurar","toggle-section":"Alternar seção","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo escuro","toggle-reader-mode":"Alternar modo de leitor","toggle-navigation":"Alternar de navegação","crossref-fig-title":"Figura","crossref-tbl-title":"Tabela","crossref-lst-title":"Listagem","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolário","crossref-prp-title":"Proposição","crossref-cnj-title":"Conjectura","crossref-def-title":"Definição","crossref-exm-title":"Exemplo","crossref-exr-title":"Exercício","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Seção","crossref-eq-prefix":"Equação","crossref-lof-title":"Lista de Figuras","crossref-lot-title":"Lista de Tabelas","crossref-lol-title":"Lista de Listagens","environment-proof-title":"Comprovação","environment-remark-title":"Comentário","environment-solution-title":"Solução","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.549","bibliography":["referencias.bib"],"csl":"plos.csl","opts_chunk":{"fig.align":"center"},"theme":["cosmo","custom.scss"],"callout-appearance":"simple"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"freese":"auto","engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","include-in-header":["preamble.tex"],"output-file":"cap04.pdf"},"language":{"toc-title-document":"Índice","toc-title-website":"Nesta página","related-formats-title":"Outros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fonte","other-links-title":"Outros Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Caderno de Artigo","notebook-preview-download":"Baixar Caderno","notebook-preview-download-src":"Baixar código-fonte","notebook-preview-back":"Voltar ao Artigo","manuscript-meca-bundle":"Arquivo MECA","section-title-abstract":"Resumo","section-title-appendices":"Apêndices","section-title-footnotes":"Notas de rodapé","section-title-references":"Referências","section-title-reuse":"Reuso","section-title-copyright":"Direito autoral","section-title-citation":"Citação","appendix-attribution-cite-as":"Por favor, cite este trabalho como:","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"Autor","title-block-author-plural":"Autores","title-block-affiliation-single":"Afiliação","title-block-affiliation-plural":"Afiliações","title-block-published":"Data de Publicação","title-block-modified":"Modified","title-block-keywords":"Palavras-chave","callout-tip-title":"Dica","callout-note-title":"Nota","callout-warning-title":"Aviso","callout-important-title":"Importante","callout-caution-title":"Cuidado","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar o código","code-tools-hide-all-code":"Esconder o código","code-tools-view-source":"Ver o código fonte","code-tools-source-code":"Código fonte","tools-share":"Share","tools-download":"Download","code-line":"Linha","code-lines":"Linhas","copy-button-tooltip":"Copiar para a área de transferência","copy-button-tooltip-success":"Copiada","repo-action-links-edit":"Editar essa página","repo-action-links-source":"Ver o código fonte","repo-action-links-issue":"Criar uma issue","back-to-top":"De volta ao topo","search-no-results-text":"Nenhum resultado","search-matching-documents-text":"documentos correspondentes","search-copy-link-title":"Copiar link para a busca","search-hide-matches-text":"Esconder correspondências adicionais","search-more-match-text":"mais correspondência neste documento","search-more-matches-text":"mais correspondências neste documento","search-clear-button-title":"Limpar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Procurar","toggle-section":"Alternar seção","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo escuro","toggle-reader-mode":"Alternar modo de leitor","toggle-navigation":"Alternar de navegação","crossref-fig-title":"Figura","crossref-tbl-title":"Tabela","crossref-lst-title":"Listagem","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolário","crossref-prp-title":"Proposição","crossref-cnj-title":"Conjectura","crossref-def-title":"Definição","crossref-exm-title":"Exemplo","crossref-exr-title":"Exercício","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Seção","crossref-eq-prefix":"Equação","crossref-lof-title":"Lista de Figuras","crossref-lot-title":"Lista de Tabelas","crossref-lol-title":"Lista de Listagens","environment-proof-title":"Comprovação","environment-remark-title":"Comentário","environment-solution-title":"Solução","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"block-headings":true,"bibliography":["referencias.bib"],"csl":"plos.csl","opts_chunk":{"fig.align":"center"},"documentclass":"scrbook","fontfamily":"libertinus"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}