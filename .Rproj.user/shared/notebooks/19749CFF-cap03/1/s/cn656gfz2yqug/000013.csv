"0","#| echo: false"
"0","#| message: false"
"0","#| include: false"
"0","#| warning: false"
"0","#| cache: true"
"0",""
"0","#----- grafico com numero de UCs ativas e numero acumulado de encontros por ano"
"0","monitora %>%"
"0","  filter(ano != 2023) %>%"
"0","  distinct(bioma, uc, ano, ea, data, esforco) %>%"
"0","  group_by(bioma, ano) %>%"
"0","  summarise(esforco_anual = sum(esforco),"
"0","            ucs = n_distinct(uc)) %>%"
"0","  left_join(monitora %>%"
"0","              arrange(ano) %>%"
"0","              distinct(taxon_validado, .keep_all = TRUE) %>%"
"0","              group_by(bioma, ano) %>%"
"0","              count() %>%"
"0","              ungroup() %>%"
"0","              rename(taxa_registrados = n),"
"0","            by = c(""bioma"", ""ano"")) %>%"
"0","  mutate(taxon_acumulado = cumsum(taxa_registrados)) %>%"
"0","  relocate(taxon_acumulado, .after = esforco_anual) %>%"
"0","  mutate(taxon_acumulado = case_when(is.na(taxon_acumulado) ~ max(taxon_acumulado, na.rm = TRUE),"
"0","                                     .default = taxon_acumulado)) %>%"
"0","  ggplot(aes(x=ano)) +"
"0","  geom_bar(aes(y = ucs*10), stat = ""identity"", "
"0","           fill = ""lightgreen"", colour = ""lightgreen"") +"
"0","  geom_line(aes(y = taxon_acumulado), stat = ""identity"", colour = ""darkgreen"", linewidth = 0.8) +"
"0","  scale_y_continuous("
"0","    name = ""Taxa validados (acumulado)"",  # features of first axis"
"0","    sec.axis = sec_axis(~.*0.1, name=""NÃºmero de UCs""), # add second axis and specify its features"
"0","    expand = c(0, 0)"
"0","  ) +"
"0","  scale_x_continuous(breaks = seq(2014, 2022, 2)) +"
"0","  theme_classic() +"
"0","  theme(strip.text.x = element_text(size = 16)) +"
"0","  theme(strip.background = element_blank()) +"
"0","  theme(axis.text.x = element_text(size = 12)) +"
"0","  theme(axis.text.y = element_text(size = 12)) +"
"0","  facet_wrap(~ bioma, scales = ""free"")"
