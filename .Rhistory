annotate(
"text", x = 2.5, y = 7.5, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
# stat_regline_equation(
#   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")),
#   label.x = ,
#   label.y = ,
#   color = "black"
# ) +
annotate(
"text", x = 2.45, y = 8, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 7.5, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
# stat_regline_equation(
#   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")),
#   label.x = ,
#   label.y = ,
#   color = "black"
# ) +
annotate(
"text", x = 2.4, y = 8, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 7.5, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
# stat_regline_equation(
#   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")),
#   label.x = ,
#   label.y = ,
#   color = "black"
# ) +
annotate(
"text", x = 2.35, y = 8, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 7.5, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
# stat_regline_equation(
#   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")),
#   label.x = ,
#   label.y = ,
#   color = "black"
# ) +
annotate(
"text", x = 2.3, y = 8, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 7.5, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
correlacao_taxas_avistamento_mamiferos_aves <- taxa_avistamento_total_classe_uc %>%
select(uc, classe, taxa_avist_media) %>%
spread(key = classe, value = taxa_avist_media)
# Correlacao de pearson
cor_pearson <- correlacao_taxas_avistamento_mamiferos_aves %>%
select_if(
is.double
) %>%
inspect_cor(
method = "pearson"
)
# Teste de correlação
cor_test <- cor.test(correlacao_taxas_avistamento_mamiferos_aves$Mammalia, correlacao_taxas_avistamento_mamiferos_aves$Aves)
# Ver resultado do teste de correlação
print(cor_test)
# Extrair coeficiente de correlação e valor p
cor_value <- cor_test$estimate
p_value <- cor_test$p.value
?cor.test()
# Teste de correlação
cor_test <- cor.test(correlacao_taxas_avistamento_mamiferos_aves$Mammalia, correlacao_taxas_avistamento_mamiferos_aves$Aves, method = "pearson")
# Ver resultado do teste de correlação
print(cor_test)
# Extrair coeficiente de correlação e valor p
cor_value <- cor_test$estimate
p_value <- cor_test$p.value
p_value_1 <- 0.001
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
# stat_regline_equation(
#   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")),
#   label.x = ,
#   label.y = ,
#   color = "black"
# ) +
annotate(
"text", x = 2.3, y = 8, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 7.5, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
# stat_regline_equation(
#   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")),
#   label.x = ,
#   label.y = ,
#   color = "black"
# ) +
annotate(
"text", x = 2.3, y = 9, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 8.5, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
# stat_regline_equation(
#   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")),
#   label.x = ,
#   label.y = ,
#   color = "black"
# ) +
annotate(
"text", x = 2.3, y = 10, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 9.5, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
# stat_regline_equation(
#   aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~~")),
#   label.x = ,
#   label.y = ,
#   color = "black"
# ) +
annotate(
"text", x = 2.3, y = 9.5 label = paste("r = 0.75"), color = "black"
G_correlacao_taxas_avistamento__mamiferos_aves
#| label: fig-correlacao-taxas-avistamento
#| echo: false
#| message: false
#| warning: false
#| cache: true
#| fig.pos: 'H'
#| out.width: '70%'
#| fig-cap: "Correlação positiva entre as taxas de avistamento médias de aves e mamíferos considerando o conjunto de unidades de conservação amostradas."
correlacao_taxas_avistamento_mamiferos_aves <- taxa_avistamento_total_classe_uc %>%
select(uc, classe, taxa_avist_media) %>%
spread(key = classe, value = taxa_avist_media)
# Teste de correlação
cor_test <- cor.test(correlacao_taxas_avistamento_mamiferos_aves$Mammalia, correlacao_taxas_avistamento_mamiferos_aves$Aves, method = "pearson")
# Ver resultado do teste de correlação
print(cor_test)
# Extrair coeficiente de correlação e valor p
cor_value <- cor_test$estimate
p_value <- cor_test$p.value
p_value_1 <- 0.001
# Criar o gráfico
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
annotate(
"text", x = 2.3, y = 9.5, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 9.0, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
#| echo: false
#| message: false
#| include: false
#| warning: false
#| cache: true
correlacao_taxas_avistamento_mamiferos_aves <- taxa_avistamento_total_classe_uc %>%
select(uc, classe, taxa_avist_media) %>%
spread(key = classe, value = taxa_avist_media)
# Teste de correlação
cor_test <- cor.test(correlacao_taxas_avistamento_mamiferos_aves$Mammalia, correlacao_taxas_avistamento_mamiferos_aves$Aves, method = "pearson")
# Ver resultado do teste de correlação
print(cor_test)
# Extrair coeficiente de correlação e valor p
cor_value <- cor_test$estimate
p_value <- cor_test$p.value
p_value_1 <- 0.001
#| label: fig-correlacao-taxas-avistamento
#| echo: false
#| message: false
#| warning: false
#| cache: true
#| fig.pos: 'H'
#| out.width: '70%'
#| fig-cap: "Correlação positiva entre as taxas de avistamento médias de aves e mamíferos considerando o conjunto de unidades de conservação amostradas."
# Criar o gráfico
G_correlacao_taxas_avistamento__mamiferos_aves <- correlacao_taxas_avistamento__mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
annotate(
"text", x = 2.3, y = 9.5, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 9.0, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento__mamiferos_aves
ggsave("imagens/cap05/ma_correlacao_aves_mamiferos.jpg", plot =  G_correlacao_taxas_avistamento_mamiferos_aves, height = 4.5, width = 4.5, units = "in", dpi = 300)
G_correlacao_taxas_avistamento_mamiferos_aves <- correlacao_taxas_avistamento_mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
annotate(
"text", x = 2.3, y = 9.5, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 9.0, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento_mamiferos_aves
ggsave("imagens/cap05/ma_correlacao_aves_mamiferos.jpg", plot =  G_correlacao_taxas_avistamento_mamiferos_aves, height = 4.5, width = 4.5, units = "in", dpi = 300)
#| label: fig-ucs-eas-combinado
#| echo: false
#| message: false
#| warning: false
#| cache: true
#| fig.pos: 'H'
#| out.width: '75%'
#| fig-cap: "Número de unidades de conservação (UCs) e estações amostrais (EAs) do Programa Monitora na região amazônica por região climática com amostragem de borboletas frugívoras implementadas de 2014 a 2022."
knitr::include_graphics("imagens/cap04/bo-ucs-eas-combinados.png")
#| echo: false
#| message: false
#| include: false
#| warning: false
#| cache: true
correlacao_taxas_avistamento_mamiferos_aves <- taxa_avistamento_total_classe_uc %>%
select(uc, classe, taxa_avist_media) %>%
spread(key = classe, value = taxa_avist_media)
#| echo: false
#| include: false
#| message: false
#| warning: false
#| cache: true
############################ Script Capítulo 5 - Mastoaves  ###################
# Autores:
# Arlindo Gomes Filho,
# Elildo Carvalho Jr,
# Marcos de Souza Fialho e
# Richard Hatakeyama
##############################
# Carregando pacotes
library(tidyverse)
library(data.table)
library(descr)
library(RColorBrewer)
library(kableExtra)
library(knitr)
library(DT)
library(plotly)
library(ggthemes)
library(forcats)
library(leaflet)
library(sf)
library(rgdal)
library(treemapify)
library(reshape2)
library(randomcoloR)
library(gridExtra)
library(here)
library(htmlTable)
library(png)
library(grid)
#| echo: false
#| message: false
#| include: false
#| warning: false
#| cache: true
correlacao_taxas_avistamento_mamiferos_aves <- taxa_avistamento_total_classe_uc %>%
select(uc, classe, taxa_avist_media) %>%
spread(key = classe, value = taxa_avist_media)
# Teste de correlação
cor_test <- cor.test(correlacao_taxas_avistamento_mamiferos_aves$Mammalia, correlacao_taxas_avistamento_mamiferos_aves$Aves, method = "pearson")
# Ver resultado do teste de correlação
print(cor_test)
# Extrair coeficiente de correlação e valor p
cor_value <- cor_test$estimate
p_value <- cor_test$p.value
p_value_1 <- 0.001
#| label: fig-correlacao-taxas-avistamento
#| echo: false
#| message: false
#| warning: false
#| cache: true
#| fig.pos: 'H'
#| out.width: '70%'
#| fig-cap: "Correlação positiva entre as taxas de avistamento médias de aves e mamíferos considerando o conjunto de unidades de conservação amostradas."
# Criar o gráfico
G_correlacao_taxas_avistamento_mamiferos_aves <- correlacao_taxas_avistamento_mamiferos_aves %>%
ggplot(aes(x = Mammalia, y = Aves)) +
geom_point(color = "cyan4", size = 2) +
geom_smooth(method = "lm", col = "darkgrey") +
labs(
#title = "Correlação taxas de avistamento de mamíferos e aves",
x = "Taxa média de avistamentos (mamíferos)",
y = "Taxa média de avistamentos (aves)"
) +
annotate(
"text", x = 2.3, y = 9.5, label = paste("r = 0.75"), color = "black"
) +
annotate(
"text", x = 2.5, y = 9.0, label = paste("p <", round(p_value_1, 4)), color = "black"
) +
theme_minimal() +
theme(
axis.line = element_line(color = "black"),
axis.ticks = element_line(color = "black"),
axis.text = element_text(color = "black"),
panel.grid.minor.y = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.x = element_blank(),
)
G_correlacao_taxas_avistamento_mamiferos_aves
# Salvando o gráfico
ggsave("imagens/cap05/ma_correlacao_aves_mamiferos.jpg", plot =  G_correlacao_taxas_avistamento_mamiferos_aves, height = 4.5, width = 4.5, units = "in", dpi = 300)
